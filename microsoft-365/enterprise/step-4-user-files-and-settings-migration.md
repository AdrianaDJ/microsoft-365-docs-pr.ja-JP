---
title: 手順 4 - ユーザーのファイルと設定の移行
ms.author: jogruszc
author: JGruszczyk
manager: jemed
ms.date: 06/10/2019
ms.audience: ITPro
ms.topic: article
ms.service: o365-solutions
localization_priority: Priority
ms.collection:
- Ent_O365
- Strat_O365_Enterprise
ms.custom: ''
description: ユーザーのファイルと設定を移行する方法について説明します。
ms.openlocfilehash: 8b9bde4eb1ddf0951a2ab27795dadef9965f6a1c
ms.sourcegitcommit: 70e920f76526f47fc849df615de4569e0ac2f4be
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/07/2019
ms.locfileid: "38031492"
---
# <a name="step-4-user-files-and-settings-migration"></a><span data-ttu-id="17e59-103">手順 4: ユーザーのファイルと設定の移行</span><span class="sxs-lookup"><span data-stu-id="17e59-103">Step 4: User Files and Settings Migration</span></span>

<span data-ttu-id="17e59-104">ユーザーのファイルと設定を新しい PC や更新した PC に移動することは、重要なプロセスであり、失敗するという選択肢はありません。</span><span class="sxs-lookup"><span data-stu-id="17e59-104">Moving users’ files and settings to their new or refreshed PCs is a critical process, failure is not an option.</span></span> <span data-ttu-id="17e59-105">それぞれの PC を手動で移行することも、プロセスを自動化する複数の方法から 1 つを選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="17e59-105">You can migrate each PC manually or you choose one of several ways to automate the process.</span></span> <span data-ttu-id="17e59-106">どの移行方法を選択したとしても 3 つの大きな考慮事項があります。つまり、ユーザーのファイルの転送、それらの設定、および Windows 10 の [スタート] およびタスクバーのレイアウトの管理です。</span><span class="sxs-lookup"><span data-stu-id="17e59-106">Whichever migration method you choose there are three main considerations to be addressed – the transfer of users’ files, their settings, and managing Windows 10 Start and taskbar layouts.</span></span>

![](media/step-4-user-files-and-settings-migration-media/step-4-user-files-and-settings-migration-media-1.png)

<table>
<thead>
<td><img src="media/desktop-deployment-center-home-media/desktop-deployment-center-home-media-7.png" alt="Step 4" height="135" width="135" /></td>
<td><p><span data-ttu-id="17e59-107"><strong>手順 4: ユーザーのファイルと設定</strong></span><span class="sxs-lookup"><span data-stu-id="17e59-107"><strong>Step 4: User Files and Settings</strong></span></span></p>
<p><span data-ttu-id="17e59-p102">PC の更新時または交換時には、ユーザー状態のバックアップと復元を自動化することで時間を節約します。クラウド ファイルの同期に関する新しいオプションを使用すると、ユーザーごとの [デスクトップ]、[ドキュメント] および [ピクチャ] フォルダーの OneDrive への同期が強制実施され、新しい Windows インストールからのシームレスなファイル アクセスが可能になります。</span><span class="sxs-lookup"><span data-stu-id="17e59-p102">When refreshing or replacing PCs, save time by automating user state backup and restore. New options for cloud file sync allow you to enforce per user sync of Desktop, Documents and Pictures folders to OneDrive for seamless file access from new Windows installs.</span></span></p></td>
<td><a href="https://aka.ms/ddev4" target="_blank"><img src="media/desktop-deployment-center-home-media/desktop-deployment-center-home-media-17.png" alt="Step 4" height="130" width="231" /></a></td>
</thead>
</table>

>[!NOTE]
><span data-ttu-id="17e59-110">これまでに使用していた移行プロセスは引き続き使用できますが、Office 365 ProPlus への移行には OneDrive の「Known Folder Move」(下記参照) の使用をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="17e59-110">While you can continue to use migration processes you have used in the past, with your shift to Office 365 ProPlus we recommend you use OneDrive ‘Known Folder Move’ (see below).</span></span> <span data-ttu-id="17e59-111">デスクトップ展開プロセス全体を確認するには、[デスクトップ展開センター](https://aka.ms/HowToShift)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="17e59-111">To see the full desktop deployment process, visit the [Desktop Deployment Center](https://aka.ms/HowToShift).</span></span>
>

<span data-ttu-id="17e59-p104">大規模な展開で、最も扱いにくい、ほとんどが手動によることが多いタスクの 1 は、ユーザーのファイルと設定の転送です。この記事では、新しい PC、更新した PC および再イメージ化した PC にユーザーを移行する際に選択可能なオプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="17e59-p104">One of the trickiest and often most manual tasks of a large-scale deployment is the transferring of your users' files and settings. In this article we will cover the options available to you to migrate users to new, refreshed and re-imaged PCs.</span></span>

## <a name="manual-migration"></a><span data-ttu-id="17e59-114">手動による移行</span><span class="sxs-lookup"><span data-stu-id="17e59-114">Manual Migration</span></span>

<span data-ttu-id="17e59-p105">新しい PC や Windows の新しいバージョンに移行するときに、何を保持しておくかについて決定する際に、すべてを保持しておくことを望むユーザーもいれば、ドライブをクリーンアップする機会を得たいと考えるユーザーもいます。このため、一部の IT 部門はユーザー ファイルの移行を手動で処理することに決めて、サポート チームをユーザーの元に派遣したり、ユーザーが自分の PC をサポート チームに引き渡すためのサポート センターを開設したりします。どちらにしても、転送するものと破棄するものの決定にユーザーが関与できます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p105">When it comes to deciding on what to keep when moving to a new PC or a new version of Windows some users may want to keep everything, others may want to take the opportunity to clean up their drives. Because of this, some IT departments choose to handle user file migration manually, sometimes by having support teams visit users; sometimes by setting up support centers for users to bring their PCs to the support team. Either way users can be involved in deciding what to transfer and what to discard.</span></span>

<span data-ttu-id="17e59-p106">これが組織の選択肢の 1 つになるかどうかは、計画している移行の規模によって決まります。明らかなことは、ユーザーと直接作業して、そのニーズを理解し、新しい PC や更新された PC にファイルをコピーするための時間と物には限度があることです。</span><span class="sxs-lookup"><span data-stu-id="17e59-p106">Whether this is an option in your organization will depend on the scale of the migration you are planning. Clearly it is limited to the time and physics involved in working directly with users, understanding their needs, copying files across to their new, or freshly updated PC.</span></span>

<span data-ttu-id="17e59-p107">手動による移行を選択する場合は、そのためのタスクが Windows 7 のサポートが終了する 2020 年 1 月までに完了するかどうかを判断する必要があります。その確信がない場合は、次に示す自動化オプションの 1 つを調べるか、支援のための増員を求めてください。</span><span class="sxs-lookup"><span data-stu-id="17e59-p107">If you are opting for a manual migration, you may need to assess whether you will be able to complete the task by January 2020, when support for Windows 7 ends. If this looks doubtful, look into using one of the automated options below, or request more people to help.</span></span>

## <a name="automated-migration-using-usmt"></a><span data-ttu-id="17e59-122">USMT を使用した移行の自動化</span><span class="sxs-lookup"><span data-stu-id="17e59-122">Automated Migration using USMT</span></span> 

<span data-ttu-id="17e59-p108">大規模な展開の場合は、System Center Configuration Manager や Microsoft Deployment Toolkit (MDT) など、タスク シーケンス ベースの展開自動化ツールを使用することで、プロセスの大部分を自動化できます。どちらのソリューションも、エンドツーエンドの展開プロセスの一部として「ユーザー状態移行ツール (USMT)」を利用します。USMT は [Windows ADK (Windows Assessment and Deployment Kit)](https://docs.microsoft.com/windows-hardware/get-started/adk-install) に含まれています。</span><span class="sxs-lookup"><span data-stu-id="17e59-p108">For large-scale deployments you can automate much of the process using task sequence-based deployment automation tools such as System Center Configuration Manager or the Microsoft Deployment Toolkit (MDT). Both these solutions make use User State Migration Tool (USMT) as part of their end-to-end deployment process. USMT is part of the [Windows Assessment and Deployment Kit (Windows ADK)](https://docs.microsoft.com/windows-hardware/get-started/adk-install)</span></span>

<span data-ttu-id="17e59-p109">USMT は、ユーザー アカウント、オペレーティング システムの設定、およびアプリケーションの設定を取り込んで、新しい Windows インストールに移行します。また、IT 管理者は、移行する内容を正確に制御することも、オプションとして不要なファイルの種類 (オーディオやビデオのファイル、実行可能ファイルなど) を除外することもできます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p109">USMT captures user accounts, user files, operating system settings, and application settings, and them migrates them to a new Windows installation. It also gives you, the IT Admin, control of exactly what gets migrated and, optionally, can exclude unwanted file types – for example audio and video files, or executables.</span></span>

<span data-ttu-id="17e59-p110">移行プロセスでは、一時的な移行ストアとして機能するための十分なサーバー記憶域容量が必要になります。ここで、USMT は 2 つの重要な機能を提供します。1 つ目は、PC ごとに必要になる記憶域の容量の見積もりを出します。2 つ目は、移行ストアを暗号化して、データがファイル サーバーに格納されている間に侵害されるリスクを軽減します。</span><span class="sxs-lookup"><span data-stu-id="17e59-p110">During the migration process you will need to have sufficient server storage capacity available to act as your temporary migration store. Here USMT offers two important features. First, it can estimate, per PC, the amount of storage you will need. Second, it allows for migration stores to be encrypted, reducing the risk of data being compromised while being stored on file servers.</span></span>

<span data-ttu-id="17e59-p111">PC の更新を実行するときにプライマリ Windows パーティションを再フォーマットしない場合は、USMT にハードリンク移行ストアを使用するというオプションも選択できます。このプロセスでは、PC のユーザー状態は保持されますが、古いオペレーティング システムとアプリケーションは削除され更新されます。同じローカル パーティションからの復元プロセスを使用することで、このオプションは、パフォーマンスの大幅な向上と、ネットワーク トラフィックの削減を実現します。</span><span class="sxs-lookup"><span data-stu-id="17e59-p111">Where you are performing a PC refresh and not reformatting the primary Windows partition, you also have the option of using a hard-link migration store with USMT. This process preserves user state on the PC while the old operating system and apps are removed and refreshed. With the restore process coming from the same local partition, this option offers significant improvements on performance, and reduces network traffic.</span></span>

[<span data-ttu-id="17e59-135">ユーザー状態移行ツール (USMT) の概要</span><span class="sxs-lookup"><span data-stu-id="17e59-135">User State Migration Tool (USMT) Overview</span></span>](https://docs.microsoft.com/windows/deployment/usmt/usmt-overview)

## <a name="onedrive-known-folder-move"></a><span data-ttu-id="17e59-136">OneDrive の Known Folder Move</span><span class="sxs-lookup"><span data-stu-id="17e59-136">OneDrive Known Folder Move</span></span>

<span data-ttu-id="17e59-p112">ユーザーが OneDrive ユーザーの場合や、今回の展開の一環として OneDrive を追加する場合は、新しいオプションを選択できます。ユーザーのファイルの同期にクラウドを使用することで、OneDrive の「Known Folder Move (既知のフォルダーの移動)」機能は、ローカル ネットワーク ベースのオプションでは不可能なレベルの柔軟性を提供します。この機能を移行前に有効にしておくと、新しい PC または更新した PC に安全にアクセスできるようになります。また、自分のサーバーに一時的な移行ストアを作成する必要もなくなります。さらに、ユーザーにとって完全に透過的になる潜在力もあります。</span><span class="sxs-lookup"><span data-stu-id="17e59-p112">If your users are on OneDrive or you are adding OneDrive in as part of this deployment, there is new option available to you. Using the cloud to synchronize user files, OneDrive “Known Folder Move” feature provides a level of flexibility not possible with local network-based file migration options. If enabled prior to migration, it provides secure access on new or refreshed PCs and, it eliminates the need to create temporary migration stores on your own servers. It is also has the potential to be completely transparent to the user.</span></span>

[<span data-ttu-id="17e59-141">Windows の既知のフォルダーを OneDrive にリダイレクトして移動する</span><span class="sxs-lookup"><span data-stu-id="17e59-141">Redirect and move Windows known folders to OneDrive</span></span>](https://docs.microsoft.com/onedrive/redirect-known-folders)

<span data-ttu-id="17e59-p113">既に OneDrive を使用している場合は、ユーザーが OneDrive または SharePoint から自分のデバイスに同期するフォルダーと場所を選択できることがわかるようになりますが、実際には、そのような設定作業がエンド ユーザーに負担をかけることになります。Known Folder Move では、ユーザー プロファイル内の [ドキュメント]、[デスクトップ] および [ピクチャ] フォルダーを対象にして、そのすべてを OneDrive で保護できます。この操作はユーザーが自分で実行することもできますが、このシナリオにとって重要なのは、[グループ ポリシー設定を使用して強制適用](https://docs.microsoft.com/onedrive/use-group-policy?redirectSourcePath=%252fen-us%252farticle%252fUse-Group-Policy-to-control-OneDrive-sync-client-settings-0ecb2cf5-8882-42b3-a6e9-be6bda30899c)することもできるということです。</span><span class="sxs-lookup"><span data-stu-id="17e59-p113">If you’re already using OneDrive, you will know that users can select the folders and locations they would like to sync from OneDrive or SharePoint to their device, but that effectively puts the burden on the end user to set it up. With Known Folder Move, you can target the Documents, Desktop and Pictures folders within a user profile and protect it all on OneDrive. A user can do this themselves or, importantly for this scenario, you can [enforce this using Group Policy settings](https://docs.microsoft.com/onedrive/use-group-policy?redirectSourcePath=%252fen-us%252farticle%252fUse-Group-Policy-to-control-OneDrive-sync-client-settings-0ecb2cf5-8882-42b3-a6e9-be6bda30899c).</span></span>

<span data-ttu-id="17e59-p114">Known Folder Move では、ユーザーは自分のワークフローを変更することはありません。OneDrive との同期前、同期中、同期の完了後のいずれの時点でも、まったく変化を感じません。グループ ポリシーを使用することで、ユーザーの [ドキュメント]、[ピクチャ] および [デスクトップ] が OneDrive で保護されていることを、そのユーザーに通知するかどうかも選択できます。通知しないことを選択すると、ダイアログなどの表示なしにバックグラウンドで実行されます。ユーザーは、新しい PC の納品時または PC の更新時にのみ意識することになります。ユーザーが自分の OneDrive アカウントにサインインするとすぐに、該当するファイルが再び使用できるようになり、ユーザーの新しい PC に復元されます。当然のことながら、OneDrive を使用することで、電話などのデバイスからのファイルの安全性をいつでも維持できます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p114">With Known Folder Move, users don’t change their workflow – everything looks the same before, during and after synchronization with OneDrive is complete. Through Group Policy you can even choose whether or not to notify users that their documents, pictures and desktop are protected in OneDrive. If you choose not to, it all happens silently in the background. The users will only be aware when they take delivery of a new PC or their PC is refreshed. As soon as they sign in to their OneDrive account, these files will be available again, and will be restored to their new PC. And of course, OneDrive means they will also their files securely at any time from their phones and other devices.</span></span>

<span data-ttu-id="17e59-151">セキュリティのさらなる強化のために、Azure Active Directory を利用した OneDrive の認証は、簡単に多要素認証の使用を有効化できます。また、ネットワーク アクティビティを制限するために、OneDrive で使用するアップロードおよびダウンロードの帯域幅を制御するポリシーを設定できます。</span><span class="sxs-lookup"><span data-stu-id="17e59-151">Authentication for OneDrive powered by Azure Active Directory, so for extra security, you can easily enable multi-factor authentication, and you can set policies to control the upload and download bandwidth OneDrive uses to limit network activity.</span></span>

<span data-ttu-id="17e59-p115">すべてのユーザーを同時に移行する必要はありません。グループ ポリシー設定のロールアウトを段階化するか、[ドメインに参加している PC にファイルの同期を制限する](https://docs.microsoft.com/powershell/module/sharepoint-online/Set-SPOTenantSyncClientRestriction?view=sharepoint-ps)ことが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="17e59-p115">You don’t have to migrate every use at the same time. You may want phase the roll-out of the Group Policy settings, or [limit file sync to domain-joined PCs](https://docs.microsoft.com/powershell/module/sharepoint-online/Set-SPOTenantSyncClientRestriction?view=sharepoint-ps).</span></span>

## <a name="start-menu-and-task-bar-customization"></a><span data-ttu-id="17e59-154">[スタート] メニューとタスク バーのカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="17e59-154">Start Menu and Task Bar Customization</span></span>

<span data-ttu-id="17e59-p116">OneDrive は、ファイルとフォルダーを同期して保護することを目的としてます。アプリケーションや Windows の設定を同期するものではありません。そのために、これまではプロファイルをコピーする方法を使用して、ユーザーの [スタート] メニューとタスクバー設定の標準レイアウトを構成していました。Windows 10 Pro、Enterprise、および Education では、グループ ポリシー、MDM、PowerShell またはプロビジョニング パッケージを使用して、[カスタマイズされた [スタート] とタスクバーのレイアウト](https://docs.microsoft.com/windows/configuration/windows-10-start-layout-options-and-policies)を展開できます。再イメージングは不要です。また、レイアウトは、そのレイアウトを含んでいる .xml ファイルを上書きすることで簡単に更新できます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p116">OneDrive is designed to sync and protect files and folders; it does not sync application or Windows settings. To do this in the past you may have used the copy profile method to configure standard layouts for users’ Start menus and taskbar settings. In Windows 10 Pro, Enterprise, and Education, you can use Group Policy, MDM, PowerShell, or provisioning packages, to deploy [customized Start and taskbar layouts](https://docs.microsoft.com/windows/configuration/windows-10-start-layout-options-and-policies). No reimaging is required, and the layout can be updated simply by overwriting the .xml file that contains the layout.</span></span>

<span data-ttu-id="17e59-p117">新しいレイアウトを簡単に作成するには、サンプルのシステムを構成して、PowerShell の [Export-StartLayout](https://docs.microsoft.com/powershell/module/startlayout/export-startlayout?view=win10-ps) コマンドレットを使用して XML ファイルを生成します。このファイルをネットワーク共有に配置するか、展開シーケンスの一環としてローカルにキャッシュします。つまり、ユーザーがサインインした後で、読み取り専用ファイルとしてアクセスできることのみが必要ということです。その後で、ポリシーまたは [Import-StartLayout](https://docs.microsoft.com/powershell/module/startlayout/import-startlayout?view=win10-ps) コマンドレットを使用すると、このファイルを参照できます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p117">To create a new layout simply configure a sample system, and use the PowerShell [Export-StartLayout](https://docs.microsoft.com/powershell/module/startlayout/export-startlayout?view=win10-ps) cmdlet to generate an XML file, then place this file on a network share, or cache it locally as part of your deployment sequence; it just needs to be reachable as Read-only file once the user signs in. You can then use policy or the [Import-StartLayout](https://docs.microsoft.com/powershell/module/startlayout/import-startlayout?view=win10-ps) cmdlet to reference this file.</span></span>

## <a name="removing-unwanted-in-box-apps"></a><span data-ttu-id="17e59-161">不要な付属アプリの削除</span><span class="sxs-lookup"><span data-stu-id="17e59-161">Removing unwanted in-box apps</span></span>

<span data-ttu-id="17e59-p118">Windows 10 には、標準インストールの一部として多数の便利な組み込みアプリが含まれていますが、これらの一部は管理対象の PC から削除できます。さらに、そうしたアプリ (XBOX や Zune Music など) が元に戻せなくなるようにインストールを構成することもできます。そのようなアプリの一覧は、[PowerShell Get-AppxPackage](https://technet.microsoft.com/library/hh856044.aspx) コマンドを使用して取得できます。それらのうちの不要なものは、[Remove-AppxPackage](https://technet.microsoft.com/library/hh856038.aspx) コマンドを使用して削除できます。また、展開前に Windows イメージ (.img) ファイルをオフラインでマウントし、[Deployment Image Servicing and Management (DISM)](https://docs.microsoft.com/windows-hardware/manufacture/desktop/what-is-dism) コマンド ライン ツールと [Remove-AppxProvisionedPackage](https://docs.microsoft.com/powershell/module/dism/remove-appxprovisionedpackage?view=win10-ps) コマンドを使用して、不要なパッケージを抜き取っておくこともできます。</span><span class="sxs-lookup"><span data-stu-id="17e59-p118">Windows 10 includes many useful built-in apps as part of the standard installation, but you may want to remove some of these from your managed PCs, and even configure your installation to prevent those apps from returning, for example, XBOX or Zune Music. You can retrieve a list of these apps using the [PowerShell Get-AppxPackage](https://technet.microsoft.com/library/hh856044.aspx) commands, and remove those you do not want using the [Remove-AppxPackage](https://technet.microsoft.com/library/hh856038.aspx) command. Alternatively, you can mount the Windows Image (.img) file offline before deployment, and extract packages you do not want using the [Deployment Image Servicing and Management (DISM)](https://docs.microsoft.com/windows-hardware/manufacture/desktop/what-is-dism) command line tool and the [Remove-AppxProvisionedPackage](https://docs.microsoft.com/powershell/module/dism/remove-appxprovisionedpackage?view=win10-ps) command.</span></span>

## <a name="next-step"></a><span data-ttu-id="17e59-165">次の手順</span><span class="sxs-lookup"><span data-stu-id="17e59-165">Next Step</span></span>

## <a name="step-5-security-and-compliance-considerationshttpsakamsmdd5"></a>[<span data-ttu-id="17e59-166">手順 5: セキュリティとコンプライアンスに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="17e59-166">Step 5: Security and Compliance Considerations</span></span>](https://aka.ms/mdd5)

## <a name="previous-step"></a><span data-ttu-id="17e59-167">前の手順</span><span class="sxs-lookup"><span data-stu-id="17e59-167">Previous Step</span></span>

## <a name="step-3-office-and-lob-app-deliveryhttpsakamsmdd3"></a>[<span data-ttu-id="17e59-168">手順 3: Office および LOB アプリの配信</span><span class="sxs-lookup"><span data-stu-id="17e59-168">Step 3: Office and LOB App Delivery</span></span>](https://aka.ms/mdd3)