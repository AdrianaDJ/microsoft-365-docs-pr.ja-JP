---
title: ネットワーク アップロードを使用して、RMS で暗号化された PST ファイルを Office 365 にインポートする
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.collection: M365-security-compliance
localization_priority: Normal
search.appverid:
- MOE150
- MED150
- MET150
ms.assetid: 84a595b8-cd77-4f66-ac52-57a33ddd4773
description: ネットワークアップロードを使用して、RMS で暗号化された PST ファイルを Office 365 のユーザーメールボックスにインポートする方法について説明します。
ms.openlocfilehash: 59aa489d6f4a3dd2545d5a2475f9e70e65529230
ms.sourcegitcommit: 0ad0092d9c5cb2d69fc70c990a9b7cc03140611b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/19/2019
ms.locfileid: "40802292"
---
# <a name="use-network-upload-to-import-rms-encrypted-pst-files-to-office-365"></a><span data-ttu-id="b87a3-103">ネットワーク アップロードを使用して、RMS で暗号化された PST ファイルを Office 365 にインポートする</span><span class="sxs-lookup"><span data-stu-id="b87a3-103">Use network upload to import RMS-encrypted PST files to Office 365</span></span>

<span data-ttu-id="b87a3-104">**この記事は、管理者を対象としています。PST ファイルを自分のメールボックスにインポートしようとしていますか?「 [Outlook .pst ファイルからメール、連絡先、予定表をインポートする](https://go.microsoft.com/fwlink/p/?LinkID=785075)」を参照してください。**</span><span class="sxs-lookup"><span data-stu-id="b87a3-104">**This article is for administrators. Are you trying to import PST files to your own mailbox? See [Import email, contacts, and calendar from an Outlook .pst file](https://go.microsoft.com/fwlink/p/?LinkID=785075)**</span></span>
   
<span data-ttu-id="b87a3-105">ユーザーのメールボックスに PST ファイルをインポートするには、ネットワークアップロードオプションと Office 365 インポートサービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-105">Use the network upload option and the Office 365 Import service to import PST files to user mailboxes.</span></span> <span data-ttu-id="b87a3-106">ネットワーク アップロードとは、Microsoft クラウドの一時的な記憶域に PST ファイルをアップロードすることを意味します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-106">Network upload means that you upload the PST files a temporary storage area in the Microsoft cloud.</span></span> <span data-ttu-id="b87a3-107">その後、Office 365 インポート サービスが記憶域からユーザーのメールボックスに PST ファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-107">Then the Office 365 Import service copies the PST files from the storage area to the target user mailboxes.</span></span> <span data-ttu-id="b87a3-108">インポートサービスの新機能により、PST ファイルを暗号化して Microsoft クラウドに保存することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-108">A new feature of the Import service lets you encrypt your PST files before they are uploaded and stored on the Microsoft cloud.</span></span> <span data-ttu-id="b87a3-109">これらのファイルは、ユーザー メールボックスへのインポート時には暗号化されません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-109">These files will be un-encrypted when they're imported to user mailboxes.</span></span> 
  
<span data-ttu-id="b87a3-110">PST ファイルを暗号化して Office 365 メールボックスにインポートするために必要な手順は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-110">Here are the steps required to encrypt and import PST files to Office 365 mailboxes:</span></span>
  
[<span data-ttu-id="b87a3-111">手順 1: PST インポートの Azure Rights Management をセットアップする</span><span class="sxs-lookup"><span data-stu-id="b87a3-111">Step 1: Set up Azure Rights Management for PST Import</span></span>](#step-1-set-up-azure-rights-management-for-pst-import)

[<span data-ttu-id="b87a3-112">手順 2:PST インポートの暗号化キーを生成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-112">Step 2: Generate an encryption key for PST Import</span></span>](#step-2-generate-an-encryption-key-for-pst-import)

[<span data-ttu-id="b87a3-113">手順 3: RMS テナント ID とライセンス URL を取得する</span><span class="sxs-lookup"><span data-stu-id="b87a3-113">Step 3: Obtain RMS tenant ID and licensing URL</span></span>](#step-3-obtain-rms-tenant-id-and-licensing-url)

[<span data-ttu-id="b87a3-114">手順 4: PST インポートツールをダウンロードして、SAS URL をコピーする</span><span class="sxs-lookup"><span data-stu-id="b87a3-114">Step 4: Download the PST Import tools and copy the SAS URL</span></span>](#step-4-download-the-pst-import-tools-and-copy-the-sas-url)

[<span data-ttu-id="b87a3-115">手順 5: PST ファイルを暗号化して Office 365 にアップロードする</span><span class="sxs-lookup"><span data-stu-id="b87a3-115">Step 5: Encrypt and upload your PST files to Office 365</span></span>](#step-5-encrypt-and-upload-your-pst-files-to-office-365)

[<span data-ttu-id="b87a3-116">オプション手順 6: Office 365 にアップロードされた PST ファイルの一覧を表示する</span><span class="sxs-lookup"><span data-stu-id="b87a3-116">(Optional) Step 6: View a list of the PST files uploaded to Office 365</span></span>](#optional-step-6-view-a-list-of-the-pst-files-uploaded-to-office-365)

[<span data-ttu-id="b87a3-117">手順 7: PST インポートのマッピングファイルを作成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-117">Step 7: Create the PST Import mapping file</span></span>](#step-7-create-the-pst-import-mapping-file)

[<span data-ttu-id="b87a3-118">手順 8:Office 365 で PST インポート ジョブを作成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-118">Step 8: Create a PST Import job in Office 365</span></span>](#step-8-create-a-pst-import-job-in-office-365)
  
> [!IMPORTANT]
> <span data-ttu-id="b87a3-119">PST ファイルを暗号化して Office 365 メールボックスにインポートするように組織を設定および構成するには、手順 1 ~ 4 を一度だけ実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-119">You have to perform Step 1 through Step 4 only once to set up and configure your organization to encrypt and import PST files to Office 365 mailboxes.</span></span> <span data-ttu-id="b87a3-120">これらの手順を実行した後、PST ファイルのバッチを暗号化、アップロード、およびインポートするたびに、手順5から手順8に従います。</span><span class="sxs-lookup"><span data-stu-id="b87a3-120">After you perform these steps, follow Step 5 through Step 8 each time you want to encrypt, upload, and import a batch of PST files.</span></span> 
  
<span data-ttu-id="b87a3-121">Office 365 へのデータのインポートの詳細については、「[組織の PST ファイルを office 365 にインポートする」の概要](importing-pst-files-to-office-365.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-121">For more information about importing data to Office 365, see [Overview of importing your organization PST files to Office 365](importing-pst-files-to-office-365.md).</span></span>
  
## <a name="before-you-begin"></a><span data-ttu-id="b87a3-122">始める前に</span><span class="sxs-lookup"><span data-stu-id="b87a3-122">Before you begin</span></span>

- <span data-ttu-id="b87a3-123">PST ファイルを Office 365 メールボックスにインポートするには、Exchange Online で Mailbox Import Export の役割が割り当てられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-123">You have to be assigned the Mailbox Import Export role in Exchange Online to import PST files to Office 365 mailboxes.</span></span> <span data-ttu-id="b87a3-124">既定では、この役割は Exchange Online のどの役割グループにも割り当てられていません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-124">By default, this role isn't assigned to any role group in Exchange Online.</span></span> <span data-ttu-id="b87a3-125">"Mailbox Import Export/メールボックスのインポートとエクスポート" 役割は "Organization Management/組織の管理" 役割グループに追加できます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-125">You can add the Mailbox Import Export role to the Organization Management role group.</span></span> <span data-ttu-id="b87a3-126">Or you can create a new role group, assign the Mailbox Import Export role, and then add yourself as a member.</span><span class="sxs-lookup"><span data-stu-id="b87a3-126">Or you can create a new role group, assign the Mailbox Import Export role, and then add yourself as a member.</span></span> <span data-ttu-id="b87a3-127">詳細については、「[役割グループを管理する](https://go.microsoft.com/fwlink/p/?LinkId=730688)」で「役割グループに役割を追加する」または「役割グループを作成する」のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-127">For more information, see the "Add a role to a role group" or the "Create a role group" sections in [Manage role groups](https://go.microsoft.com/fwlink/p/?LinkId=730688).</span></span>
    
    <span data-ttu-id="b87a3-128">さらに、セキュリティ/コンプライアンス センターでインポート ジョブを作成するには、次のいずれかを満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-128">Additionally, to create import jobs in the Security & Compliance Center, one of the following must be true:</span></span>
    
  - <span data-ttu-id="b87a3-129">Exchange Online で Mail Recipients の役割が割り当てられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-129">You have to be assigned the Mail Recipients role in Exchange Online.</span></span> <span data-ttu-id="b87a3-130">既定では、この役割は Organization Management 役割グループと Recipient Management 役割グループに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-130">By default, this role is assigned to the Organization Management and Recipient Management roles groups.</span></span>
    
    <span data-ttu-id="b87a3-131">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-131">Or</span></span>
    
  - <span data-ttu-id="b87a3-132">Office 365 組織の全体の管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-132">You have to be a global administrator in your Office 365 organization.</span></span>
    
  > [!TIP]
  > <span data-ttu-id="b87a3-133">PST ファイルを Office 365 にインポートするための新しい役割グループを Exchange Online で作成することを検討します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-133">Consider creating a new role group in Exchange Online that's specifically intended for importing PST files to Office 365.</span></span> <span data-ttu-id="b87a3-134">PST ファイルをインポートするのに必要な最小レベルの権限では、新しい役割グループに Mailbox Import Export の役割および Mail Recipients の役割を割り当て、メンバーを追加します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-134">For the minimum level of privileges required to import PST files, assign the Mailbox Import Export and Mail Recipients roles to the new role group, and then add members.</span></span> 

- <span data-ttu-id="b87a3-135">大規模な PST ファイルは、PST インポートプロセスのパフォーマンスに影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-135">Large PST files may impact the performance of the PST import process.</span></span> <span data-ttu-id="b87a3-136">そのため、手順2で Azure ストレージの場所にアップロードする各 PST ファイルのサイズは、20 GB 以下にすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-136">So we recommend that each PST file you upload to the Azure Storage location in Step 2 should be no larger than 20 GB.</span></span>
  
- <span data-ttu-id="b87a3-137">Office 365 にインポートする PST ファイルは、組織内のファイル サーバーまたは共有フォルダーに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-137">You need to store the PST files that you want to import to Office 365 on a file server or shared folder in your organization.</span></span> <span data-ttu-id="b87a3-138">手順5では、Office 365 ImportTool を実行して、このファイルサーバーまたは共有フォルダーに保存されている PST ファイルを Office 365 に暗号化してアップロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-138">In Step 5, you'll run the Office 365 ImportTool, which will encrypt and upload the PST files that are stored on this file server or shared folder to Office 365.</span></span>
    
- <span data-ttu-id="b87a3-139">この手順では、暗号化キー、ストレージ キー、および多数の識別キーと URL のコピーをコピーして保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-139">This procedure involves copying and saving a copy of an encryption key, a storage key, and a number of identification keys and URLs.</span></span> <span data-ttu-id="b87a3-140">この情報は、手順5で PST ファイルを暗号化してアップロードするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-140">This information will be used in Step 5 to encrypt and upload your PST files.</span></span> <span data-ttu-id="b87a3-141">パスワードやその他のセキュリティ関連情報を保護するのと同じように、これらのファイルを保護するための予防策を必ず講じてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-141">Be sure to take precautions to protect these just like you would protect passwords or other security-related information.</span></span> <span data-ttu-id="b87a3-142">たとえば、パスワードで保護された Microsoft Word 文書に保存する、または暗号化された USB ドライブに保存することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-142">For example, you might save them to a password-protected Microsoft Word document or save them to an encrypted USB drive.</span></span> <span data-ttu-id="b87a3-143">これらのキー、ID、および URL の例については、「[詳細情報](#more-information)」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-143">See the [More information](#more-information) section for an example of these keys, IDs, and URLs.</span></span> 
    
- <span data-ttu-id="b87a3-144">PST ファイルを Office 365 の非アクティブなメールボックスにインポートできます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-144">You can import PST files to an inactive mailbox in Office 365.</span></span> <span data-ttu-id="b87a3-145">PST インポート マッピング ファイルの `Mailbox` パラメーターで非アクティブなメールボックスの GUID を指定して、この操作を行います。</span><span class="sxs-lookup"><span data-stu-id="b87a3-145">You do this by specifying the GUID of the inactive mailbox in the  `Mailbox` parameter in the PST Import mapping file.</span></span> <span data-ttu-id="b87a3-146">詳細については、[手順 7](#step-7-create-the-pst-import-mapping-file)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-146">See [Step 7](#step-7-create-the-pst-import-mapping-file) for more information.</span></span> 
    
- <span data-ttu-id="b87a3-147">Exchange ハイブリッド展開では、オンプレミスのプライマリ メールボックスを持つユーザーのために、PST ファイルをクラウド ベースのアーカイブ メールボックスにインポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-147">In an Exchange hybrid deployment, you can import PST files to a cloud-based archive mailbox for a user whose primary mailbox is on-premises.</span></span> <span data-ttu-id="b87a3-148">PST インポート マッピング ファイルに次を指定して、この操作を行います。</span><span class="sxs-lookup"><span data-stu-id="b87a3-148">You do this by doing the following in the PST Import mapping file:</span></span>
    
  - <span data-ttu-id="b87a3-149">`Mailbox` パラメーターに、ユーザーのオンプレミス メールボックス用のメール アドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-149">Specify the email address for the user's on-premises mailbox in the  `Mailbox` parameter.</span></span> 
    
  - <span data-ttu-id="b87a3-150">`IsArchive` パラメーターに、**TRUE** 値を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-150">Specify the **TRUE** value in the  `IsArchive` parameter.</span></span> 
    
    <span data-ttu-id="b87a3-151">詳細については、[手順 7](#step-7-create-the-pst-import-mapping-file)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-151">See [Step 7](#step-7-create-the-pst-import-mapping-file) for more information.</span></span> 
    
- <span data-ttu-id="b87a3-152">PST ファイルが Office 365 メールボックスにインポートされると、メールボックスのアイテム保持ホールド設定が無期限でオンになります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-152">After PST files are imported to an Office 365 mailbox, the retention hold setting for the mailbox is turned on for an indefinite duration.</span></span> <span data-ttu-id="b87a3-153">つまり、メールボックスに割り当てられたアイテム保持ポリシーは、アイテム保持ホールドをオフにするか、またはホールドをオフにする日付を設定するまで処理されません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-153">This means that the retention policy assigned to the mailbox won't be processed until you turn off the retention hold or set a date to turn off the hold.</span></span> <span data-ttu-id="b87a3-154">このようにした理由は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-154">Why do we do this?</span></span> <span data-ttu-id="b87a3-155">メールボックスにインポートされたメッセージは古くなると、完全に削除 (パージ) される可能性があります。これは、メッセージの保持期限がメールボックスに対して構成されたアイテム保持設定に基づいているためです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-155">If messages imported to a mailbox are old, they might be permanently deleted (purged) because their retention period has expired based on the retention settings configured for the mailbox.</span></span> <span data-ttu-id="b87a3-156">メールボックスの保存機能を有効にすると、メールボックスの所有者は新しくインポートされたメッセージを管理することができ、メールボックスの保存期間の設定を変更する時間を与えることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-156">Placing the mailbox on retention hold will give the mailbox owner time to manage these newly imported messages or give you time to change the retention settings for the mailbox.</span></span> <span data-ttu-id="b87a3-157">保持ホールドの管理に関する提案については、「 [More information](#more-information) 」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-157">See the [More information](#more-information) section for suggestions about managing the retention hold.</span></span> 
    
- <span data-ttu-id="b87a3-158">Office 365 にアップロードする前に PST ファイルを暗号化する必要がない場合は、「[ネットワークアップロードを使用して pst ファイルを office 365 にインポート](use-network-upload-to-import-pst-files.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-158">If you don't need to encrypt your PST files before you upload them to Office 365, see [Use network upload to import PST files to Office 365](use-network-upload-to-import-pst-files.md).</span></span>
    
- <span data-ttu-id="b87a3-159">ネットワークアップロードを使用して PST ファイルを Office 365 にインポートする方法についてよく寄せられる質問については、「 [office 365 への pst ファイルのインポートに関する FAQ](faqimporting-pst-files-to-office-365.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-159">For frequently asked questions about using network upload to import PST files to Office 365, see [FAQ about importing PST files to Office 365](faqimporting-pst-files-to-office-365.md).</span></span>
  
## <a name="step-1-set-up-azure-rights-management-for-pst-import"></a><span data-ttu-id="b87a3-160">手順 1:PST インポートの Azure Rights Management をセットアップする </span><span class="sxs-lookup"><span data-stu-id="b87a3-160">Step 1: Set up Azure Rights Management for PST Import</span></span>

<span data-ttu-id="b87a3-161">PST インポートでは、Office 365 の Azure Rights Management (Azure RMS) サービスが提供する暗号化機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-161">PST Import uses the encryption functionality provided by the Azure Rights Management (Azure RMS) service in Office 365.</span></span> <span data-ttu-id="b87a3-162">これにより、Office 365 にアップロードする前に PST ファイルを暗号化することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-162">This lets you encrypt PST files before uploading them to Office 365.</span></span> 
  
<span data-ttu-id="b87a3-163">PST インポート用に Azure RMS を構成するには、3つの手順から構成されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-163">Configuring Azure RMS for PST Import consists of three steps:</span></span>
  
- [<span data-ttu-id="b87a3-164">Azure RMS をアクティブ化する</span><span class="sxs-lookup"><span data-stu-id="b87a3-164">Activating Azure RMS</span></span>](#activating-azure-rms)
    
- [<span data-ttu-id="b87a3-165">Exchange Online で RMS を構成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-165">Configuring RMS in Exchange Online</span></span>](#configuring-rms-in-exchange-online)
    
- [<span data-ttu-id="b87a3-166">Active Directory RMS クライアントのインストール</span><span class="sxs-lookup"><span data-stu-id="b87a3-166">Installing the Active Directory RMS Client</span></span>](#installing-the-active-directory-rms-client)
    
### <a name="activating-azure-rms"></a><span data-ttu-id="b87a3-167">Azure RMS をアクティブ化する</span><span class="sxs-lookup"><span data-stu-id="b87a3-167">Activating Azure RMS</span></span>

<span data-ttu-id="b87a3-168">Azure RMS は既定で無効になっていますが、組織内の別の管理者がライセンス認証を行った可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-168">Azure RMS is disabled by default, but you or another administrator in your organization might have activated it.</span></span> <span data-ttu-id="b87a3-169">[Azure Rights Management をアクティブ化](https://docs.microsoft.com/azure/information-protection/deploy-use/activate-service)して azure DRM をインストールしてアクティブ化する手順に従います。</span><span class="sxs-lookup"><span data-stu-id="b87a3-169">Follow instructions on [Activating Azure Rights Management](https://docs.microsoft.com/azure/information-protection/deploy-use/activate-service) to install and activate Azure DRM.</span></span>
  
### <a name="configuring-rms-in-exchange-online"></a><span data-ttu-id="b87a3-170">Exchange Online で RMS を構成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-170">Configuring RMS in Exchange Online</span></span>

<span data-ttu-id="b87a3-171">Rights Management サービスをアクティブ化した後、次の手順では、Azure RMS を使用するために Exchange Online で Information Rights Management (IRM) をセットアップします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-171">After you've activated the Rights Management service, the next step is to set up Information Rights Management (IRM) in Exchange Online to use Azure RMS.</span></span> <span data-ttu-id="b87a3-172">詳細については、「 [Azure Rights Management を使用するように IRM を構成する](https://go.microsoft.com/fwlink/p/?LinkId=394816)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-172">For more information, see [Configure IRM to use Azure Rights Management](https://go.microsoft.com/fwlink/p/?LinkId=394816).</span></span>
  
1. <span data-ttu-id="b87a3-173">[リモート PowerShell を使用して Exchange Online に接続](https://go.microsoft.com/fwlink/p/?LinkId=396554 )します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-173">[Connect to Exchange Online using Remote PowerShell](https://go.microsoft.com/fwlink/p/?LinkId=396554 ).</span></span>
    
2. <span data-ttu-id="b87a3-174">次のコマンドを実行して、RMS キー共有 URL を設定する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-174">Run the following command to set the RMS key sharing URL.</span></span>
    
    ```powershell
    Set-IRMConfiguration -RMSOnlineKeySharingLocation <RMS key sharing location>
    ```

    <span data-ttu-id="b87a3-175">組織の場所の正しい RMS キー共有場所を決定するには、次の表を使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-175">Use the following table to determine the correct RMS key sharing location for the location of your organization.</span></span>
    
    |<span data-ttu-id="b87a3-176">**Location**</span><span class="sxs-lookup"><span data-stu-id="b87a3-176">**Location**</span></span>|<span data-ttu-id="b87a3-177">**RMS キー共有場所**</span><span class="sxs-lookup"><span data-stu-id="b87a3-177">**RMS key sharing location**</span></span>|
    |:-----|:-----|
    |<span data-ttu-id="b87a3-178">北アメリカ</span><span class="sxs-lookup"><span data-stu-id="b87a3-178">North America</span></span>  <br/> | `https://sp-rms.na.aadrm.com/TenantManagement/ServicePartner.svc` <br/> |
    |<span data-ttu-id="b87a3-179">欧州連合</span><span class="sxs-lookup"><span data-stu-id="b87a3-179">European Union</span></span>  <br/> | `https://sp-rms.eu.aadrm.com/TenantManagement/ServicePartner.svc` <br/> |
    |<span data-ttu-id="b87a3-180">アジア</span><span class="sxs-lookup"><span data-stu-id="b87a3-180">Asia</span></span>  <br/> | `https://sp-rms.ap.aadrm.com/TenantManagement/ServicePartner.svc` <br/> |
    |<span data-ttu-id="b87a3-181">南アメリカ</span><span class="sxs-lookup"><span data-stu-id="b87a3-181">South America</span></span>  <br/> | `https://sp-rms.sa.aadrm.com/TenantManagement/ServicePartner.svc` <br/> |
    |<span data-ttu-id="b87a3-182">行政機関向け Office 365 (行政機関のコミュニティ クラウド)</span><span class="sxs-lookup"><span data-stu-id="b87a3-182">Office 365 for Government (Government Community Cloud)</span></span>  <br/> | <span data-ttu-id="b87a3-183">`https://sp-rms.govus.aadrm.com/TenantManagement/ServicePartner.svc`<sup>1-d</sup></span><span class="sxs-lookup"><span data-stu-id="b87a3-183">`https://sp-rms.govus.aadrm.com/TenantManagement/ServicePartner.svc`<sup>1</sup></span></span> <br/> |
   
    > [!NOTE]
    > <span data-ttu-id="b87a3-184"><sup>1</sup> Office 365 For government Sku (Government Community Cloud) を購入したお客様のみ、この RMS キー共有場所を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-184"><sup>1</sup> Only customers who have purchased Office 365 for Government SKUs (Government Community Cloud) should use this RMS key sharing location.</span></span> 
  
    <span data-ttu-id="b87a3-185">たとえば、次のコマンドを実行すると、北米に配置されている顧客に対して Exchange Online の RMS Online キー共有場所が構成されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-185">For example, this command configures the RMS Online key sharing location in Exchange Online for a customer located in North America.</span></span>
    
    ```powershell
    Set-IRMConfiguration -RMSOnlineKeySharingLocation "https://sp-rms.na.aadrm.com/TenantManagement/ServicePartner.svc"
    ```

3. <span data-ttu-id="b87a3-186">次のコマンドを実行して、信頼された発行ドメイン (TPD) を RMS Online から Office 365 組織にインポートします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-186">Run the following command to import a Trusted Publishing Domain (TPD) from RMS Online to your Office 365 organization.</span></span> 
    
    ```powershell
    Import-RMSTrustedPublishingDomain -RMSOnline -Name "RMS Online"
    ```

    <span data-ttu-id="b87a3-187">TPD には、PST ファイルの暗号化など、組織で RMS 機能を使用するために必要な設定が含まれています。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-187">A TPD contains the settings needed to use RMS features in your organization, including encrypting PST files.</span></span> 
    
4. <span data-ttu-id="b87a3-188">次のコマンドを実行して、Office 365 組織の IRM を有効にします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-188">Run the following command to enable IRM for your Office 365 organization.</span></span>
    
    ```powershell
    Set-IRMConfiguration -InternalLicensingEnabled $true
    ```

### <a name="installing-the-active-directory-rms-client"></a><span data-ttu-id="b87a3-189">Active Directory RMS クライアントのインストール</span><span class="sxs-lookup"><span data-stu-id="b87a3-189">Installing the Active Directory RMS Client</span></span>

<span data-ttu-id="b87a3-190">このセクションの最後の手順で、Rights Management サービス (RMS) クライアント 2.1 をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-190">The last step in this section is to download the Rights Management Services (RMS) Client 2.1.</span></span> <span data-ttu-id="b87a3-191">このソフトウェアは、azure RMS へのアクセスを保護し、Azure RMS を使用するアプリケーションを経由する情報を保護するのに役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-191">This software helps protect access to Azure RMS and protects information flowing through applications that use Azure RMS.</span></span> <span data-ttu-id="b87a3-192">手順5で PST ファイルの暗号化とアップロードに使用するのと同じコンピューターに RMS クライアントをインストールします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-192">Install the RMS client on the same computer that you'll use to encrypt and upload PST files in Step 5.</span></span> 
  
1. <span data-ttu-id="b87a3-193">[Rights Management サービスクライアント 2.1](https://www.microsoft.com/download/details.aspx?id=38396)をダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-193">Download [Rights Management Service Client 2.1](https://www.microsoft.com/download/details.aspx?id=38396).</span></span>
    
2. <span data-ttu-id="b87a3-194">Active Directory Rights Management サービス クライアント 2.1 ウィザードを実行して、クライアントをインストールする。</span><span class="sxs-lookup"><span data-stu-id="b87a3-194">Run the Active Directory Rights Management Service Client 2.1 wizard to install the client.</span></span>

## <a name="step-2-generate-an-encryption-key-for-pst-import"></a><span data-ttu-id="b87a3-195">手順 2:PST インポートの暗号化キーを生成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-195">Step 2: Generate an encryption key for PST Import</span></span>

<span data-ttu-id="b87a3-196">Azure RMS をセットアップしたら、次の手順として、Office 365 にアップロードする PST ファイルを暗号化するために使用される暗号化キー (対称キーと呼ばれる) を生成します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-196">After you've set up Azure RMS, the next step is to generate an encryption key (called a symmetric key) that will be used to encrypt the PST files that you upload to Office 365.</span></span> <span data-ttu-id="b87a3-197">これを行うには、Azure Active Directory のサービスプリンシパルとして PST インポートサービスを追加します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-197">You'll do this by adding the PST Import service as a service principal in Azure Active Directory.</span></span> <span data-ttu-id="b87a3-198">このアプリケーションをサービスプリンシパルとして追加すると、手順5で pst ファイルを暗号化して Azure ストレージの場所にアップロードするときに、PST インポートサービスが Azure Active Directory を直接認証できるようになります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-198">Adding this application as a service principal will allow the PST Import service to authenticate directly with Azure Active Directory when you upload encrypted the PST files to the Azure Storage location in Step 5.</span></span>
  
1. <span data-ttu-id="b87a3-199">Windows PowerShell の Azure Active Directory モジュールを開始します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-199">Start the Azure Active Directory Module for Windows PowerShell.</span></span>
    
2. <span data-ttu-id="b87a3-200">次のコマンドを実行して、Microsoft Online サービスに接続する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-200">Run the following command to connect to the Microsoft Online service.</span></span>
    
    ```powershell
    Connect-MsolService
    ```

3. <span data-ttu-id="b87a3-201">Office 365 組織の管理者アカウントの資格情報を入力し、[ **OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-201">Enter the credentials for an administrator account in your Office 365 organization, and then click **OK**.</span></span>
    
4. <span data-ttu-id="b87a3-202">次のコマンドを実行して、暗号化キー (対称キーと呼ばれる) を生成する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-202">Run the following command to generate an encryption key (call a symmetric key).</span></span> <span data-ttu-id="b87a3-203">これを行うには、新しい PST 暗号化プリンシパルを作成します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-203">You'll do this by creating a new PST Encryption Principal.</span></span>
    
    ```powershell
    New-MsolServicePrincipal -DisplayName PstEncryptionPrincipal
    ```

    <span data-ttu-id="b87a3-204">システムには、新しい PST 暗号化プリンシパルの対称キーとプロパティが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-204">The system displays the symmetric key and the properties for the new PST Encryption Principal.</span></span>
    
    ![表示されている対称キーをコピーして保存する](media/0003fdea-dace-41d2-b49d-f5c98c6230ca.png)
  
5. <span data-ttu-id="b87a3-p118">対称キーをテキスト ファイルまたは Word ファイルにコピーする。前述したように、必ずこのファイルを保護する予防策を講じてください。対称キーが表示されるのはこの時だけであるため、このウィンドウのスクリーンショットを撮り、同じファイルに保存することも検討してください。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-p118">Copy the symmetric key to a text or Word file. As previously stated, be sure to take precautions to protect this file. Because this is the only time that the symmetric key is displayed, you might also consider taking a screenshot of this window and saving it to the same file.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="b87a3-209">PST 暗号化プリンシパルの作成後は、**Get-MsolServicePrincipal** コマンドレットを使用して対称キーを取得することはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-209">After you create the PST Encryption Principal, you won't be able to retrieve the symmetric key by using the **Get-MsolServicePrincipal** cmdlet.</span></span> <span data-ttu-id="b87a3-210">このためキーを保存することが重要になります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-210">That's why it's important to save the key.</span></span> 
  
<span data-ttu-id="b87a3-211">Windows PowerShell 用 Azure Active Directory モジュールを開いたままにして、Microsoft Online サービスに接続します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-211">Keep the Azure Active Directory Module for Windows PowerShell open and connected to the Microsoft Online service.</span></span> <span data-ttu-id="b87a3-212">次の手順では、このウィンドウでコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-212">You'll run a command in this window in the next step.</span></span>

## <a name="step-3-obtain-rms-tenant-id-and-licensing-url"></a><span data-ttu-id="b87a3-213">手順 3: RMS テナント ID とライセンス URL を取得する</span><span class="sxs-lookup"><span data-stu-id="b87a3-213">Step 3: Obtain RMS tenant ID and licensing URL</span></span>

<span data-ttu-id="b87a3-214">次の手順では、組織の Azure RMS サービスのテナント ID とライセンスの場所の URL を取得します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-214">The next step is to obtain the tenant ID and licensing location URL for the Azure RMS service for your organization.</span></span> <span data-ttu-id="b87a3-215">手順 2 の対称キーが保存されている同じファイルに、この情報をコピーして保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-215">Copy and save this information to the same file that contains the symmetric key from Step 2.</span></span> <span data-ttu-id="b87a3-216">ID と URL は、手順5で PST ファイルを暗号化するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-216">The ID and URL will be used in Step 5 to encrypt your PST files.</span></span>
  
1. <span data-ttu-id="b87a3-217">(Microsoft Online service に接続されている) Windows PowerShell 用 Azure Active Directory モジュールで、次のコマンドを実行して Office 365 組織の Azure RMS サービスに接続します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-217">In the Azure Active Directory Module for Windows PowerShell (which is connected to the Microsoft Online service), run the following command to connect to the Azure RMS service in your Office 365 organization.</span></span>
    
    ```powershell
    Connect-AadrmService 
    ```

2. <span data-ttu-id="b87a3-218">Office 365 組織の管理者アカウントの資格情報を入力し、[ **OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-218">Enter the credentials for an administrator account in your Office 365 organization and then click **OK**.</span></span>
    
3. <span data-ttu-id="b87a3-219">Office 365 組織の Azure RMS サービスのテナント ID を表示するには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-219">Run the following command to display the tenant ID for the Azure RMS service in your Office 365 organization.</span></span>
    
    ```powershell
    Get-AadrmConfiguration | FL BPOSId
    ```

    <span data-ttu-id="b87a3-220">`BPOSId`プロパティの値をコピーして保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-220">Copy and save the value for the  `BPOSId` property.</span></span> 
    
4. <span data-ttu-id="b87a3-221">Azure RMS サービスのライセンスの場所を表示するには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-221">Run the following command to display the licensing location for your Azure RMS service.</span></span>
    
    ```powershell
    Get-AadrmConfiguration | FL LicensingIntranetDistributionPointUrl
    ```

    <span data-ttu-id="b87a3-222">`LicensingIntranetDistributionPointUrl`プロパティの値をコピーして保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-222">Copy and save the value for the  `LicensingIntranetDistributionPointUrl` property.</span></span> 

## <a name="step-4-download-the-pst-import-tools-and-copy-the-sas-url"></a><span data-ttu-id="b87a3-223">手順 4: PST インポートツールをダウンロードして、SAS URL をコピーする</span><span class="sxs-lookup"><span data-stu-id="b87a3-223">Step 4: Download the PST Import tools and copy the SAS URL</span></span>

<span data-ttu-id="b87a3-224">Azure RMS を構成し、PST ファイルを暗号化するために必要な Id を取得したので、次の手順では、手順5で実行するツールをダウンロードしてインストールし、PST ファイルを暗号化して Office 365 にアップロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-224">Now that you've configured Azure RMS and obtained the IDs necessary to encrypt PST files, the next step is to download and install the tools that you will run in Step 5 to encrypt and upload PST files to Office 365.</span></span> <span data-ttu-id="b87a3-225">これらのツールは、Azure AzCopy ツールおよび Office 365 データ暗号化ツールです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-225">These tools are the Azure AzCopy tool and the Office 365 Data Encryption tool.</span></span> <span data-ttu-id="b87a3-226">組織の SAS URL もコピーします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-226">You'll also copy the SAS URL for your organization.</span></span> <span data-ttu-id="b87a3-227">この URL は、組織の Microsoft クラウドにある Azure Storage の場所のネットワーク URL と、Shared Access Signature (SAS) キーの組み合わせです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-227">This URL is a combination of the network URL for the Azure Storage location in the Microsoft cloud for your organization and a Shared Access Signature (SAS) key.</span></span> <span data-ttu-id="b87a3-228">このキーでは、Azure Storage の場所に PST ファイルをアップロードするために必要な権限が与えられます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-228">This key provides you with the necessary permissions to upload PST files to your Azure Storage location.</span></span> <span data-ttu-id="b87a3-229">手順2と手順3で、他の情報をコピーしたのと同じファイルに保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-229">Save it to the same file that you've copied the other information to in Step 2 and Step 3.</span></span> <span data-ttu-id="b87a3-230">前述したように、SAS URL を保護するための予防措置を講じます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-230">As previously stated, take precautions to protect the SAS URL.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="b87a3-231">Azure のストレージの場所に PST ファイルを正常にアップロードするには、Azure AzCopy バージョン5.0 を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-231">You have to use Azure AzCopy version 5.0 to successfully upload PST files to the Azure storage location.</span></span> <span data-ttu-id="b87a3-232">新しいバージョンの AzCopy ツールは、Office 365 に PST ファイルをインポートするためにサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-232">Newer versions of the AzCopy tool aren't supported for importing PST files to Office 365.</span></span> <span data-ttu-id="b87a3-233">この手順の手順に従って、[**ネットワーク経由でファイルをアップロード**する] ページから azcopy ツールをダウンロードしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-233">Be sure to download the AzCopy tool from the **Upload files over the network** page by following the procedures in this step.</span></span> 
  
1. <span data-ttu-id="b87a3-234">[https://protection.office.com](https://protection.office.com) に移動します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-234">Go to [https://protection.office.com](https://protection.office.com).</span></span>
    
2. <span data-ttu-id="b87a3-235">Office 365 組織の管理者アカウントの資格情報を使用して、Office 365 にサインインします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-235">Sign in to Office 365 using the credentials for an administrator account in your Office 365 organization.</span></span>
    
3. <span data-ttu-id="b87a3-236">左側のウィンドウで、[**情報ガバナンス** \> \*\*\*\* \> ] [ **PST ファイルのインポート**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-236">In the left pane, click **Information governance** \> **Import** \> **Import PST files**.</span></span>
    
4. <span data-ttu-id="b87a3-237">[ **PST ファイルのインポート**] ページで、[**インポートサービスに移動] を**クリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-237">On the **Import PST files** page, click **Go to the Import service**.</span></span>
    
5. <span data-ttu-id="b87a3-238">[ **Office へのデータのインポート 365** ] ページで、[**新しいジョブ** ![の追加] アイコン](media/ITPro-EAC-AddIcon.gif)をクリックし、[**電子メールメッセージ (PST ファイル) のアップロード**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-238">On the **Import data to Office 365** page, click **New job** ![Add Icon](media/ITPro-EAC-AddIcon.gif), and then click **Upload email messages (PST files)**.</span></span>
    
6. <span data-ttu-id="b87a3-239">[**ネットワーク経由でファイルをアップロード**する] ページの手順2で、[**ネットワークアップロード SAS URL を表示する**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-239">On the **Upload files over the network** page, in step 2, click **Show network upload SAS URL**.</span></span>
    
7. <span data-ttu-id="b87a3-240">URL が表示されたら、それをコピーして、他のキーを保存したファイルに保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-240">After the URL is displayed, copy it and save it in the file where you saved the other keys.</span></span> <span data-ttu-id="b87a3-241">必ず URL 全体をコピーする。</span><span class="sxs-lookup"><span data-stu-id="b87a3-241">Be sure to copy the entire URL.</span></span> 
    
8. <span data-ttu-id="b87a3-242">手順3で、[ **Azure azcopy ツールのダウンロード**] をクリックして、Azure azcopy ツールをダウンロードしてインストールします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-242">In step 3, click **Download the Azure AzCopy tool** to download and install the Azure AzCopy tool.</span></span> 
    
9. <span data-ttu-id="b87a3-243">ポップアップ ウィンドウで、**[実行]** をクリックして、Azure AzCopy ツールをインストールする。</span><span class="sxs-lookup"><span data-stu-id="b87a3-243">In the pop-up window, click **Run** to install the Azure AzCopy tool.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="b87a3-244">必ず、64ビットの Windows を実行しているコンピューター `%ProgramFiles(x86)%\Microsoft SDKs\Azure\AzCopy`上の、既定の場所に Azure azcopy ツールをインストールしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-244">Be sure to install the Azure AzCopy tool in the default location, which is `%ProgramFiles(x86)%\Microsoft SDKs\Azure\AzCopy` on a computer running 64-bit Windows.</span></span> <span data-ttu-id="b87a3-245">これは、手順5で O365importtool.zip を実行したときに、この場所で AzCopy ツールを検索するためです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-245">That's because when you run the O365ImportTool.exe in Step 5, it looks for the AzCopy tool in this location.</span></span> 
  
10. <span data-ttu-id="b87a3-246">Azure AzCopy ツールをインストールした後、[ **Office 365 データ暗号化およびインポートツールをダウンロード**する] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-246">After you've installed the Azure AzCopy tool, click **Download the Office 365 Data Encryption and Import tool**.</span></span>
    
11. <span data-ttu-id="b87a3-247">ポップアップウィンドウで、[名前を付け\*\*\*\* \> **て**保存] をクリックして、o365importtool.zip ファイルをローカルコンピューター上のフォルダーに保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-247">In the pop-up window, click **Save** \> **Save as** to save the O365ImportTool.zip file to a folder on your local computer.</span></span> 
    
12. <span data-ttu-id="b87a3-248">O365ImportTool.zip ファイルを抽出する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-248">Extract the O365ImportTool.zip file.</span></span>
    
13. <span data-ttu-id="b87a3-249">[**キャンセル**] をクリックして、[**ネットワーク経由でファイルをアップロード**する] ページを閉じます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-249">Click **Cancel** to close the **Upload files over the network** page.</span></span> 
 
## <a name="step-5-encrypt-and-upload-your-pst-files-to-office-365"></a><span data-ttu-id="b87a3-250">手順 5: PST ファイルを暗号化して Office 365 にアップロードする</span><span class="sxs-lookup"><span data-stu-id="b87a3-250">Step 5: Encrypt and upload your PST files to Office 365</span></span>

<span data-ttu-id="b87a3-251">手順 1 ~ 手順4を完了したら、O365importtool.zip ツールを使用して、PST ファイルを暗号化して Office 365 にアップロードすることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-251">After you have completed Step 1 through Step 4, you're ready to use the O365ImportTool.exe tool to encrypt and upload PST files to Office 365.</span></span> <span data-ttu-id="b87a3-252">このツールは、PST ファイルを暗号化してから、Microsoft クラウド内の Azure ストレージの場所にアップロードして保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-252">This tool encrypts your PST files and then uploads and stores them in an Azure Storage location in the Microsoft cloud.</span></span> <span data-ttu-id="b87a3-253">この手順を完了するには、PST ファイルを組織内のファイル共有やファイル サーバーに配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-253">To complete this step, the PST files have to be located in a file share or file server in your organization.</span></span> <span data-ttu-id="b87a3-254">これは、次の手順でソース ディレクトリと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-254">This is known as the source directory in the following procedure.</span></span> <span data-ttu-id="b87a3-255">O365ImportTool.exe ツールを実行するたびに、異なるソース ディレクトリを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-255">Each time you run the O365ImportTool.exe tool, you'll can specify a different source directory.</span></span> 

> [!NOTE]
> <span data-ttu-id="b87a3-256">前述したように、Azure ストレージの場所にアップロードする PST ファイルのサイズは、20 GB 以下にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-256">As previously stated, each PST file that you upload to the Azure Storage location should be no larger than 20 GB.</span></span> <span data-ttu-id="b87a3-257">20 GB を超える PST ファイルは、手順8で開始する PST インポートプロセスのパフォーマンスに影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-257">PST files larger than 20 GB may impact the performance of the PST import process that you start in Step 8.</span></span>
  
1. <span data-ttu-id="b87a3-258">ローカル コンピューター上でコマンド プロンプトを開く。</span><span class="sxs-lookup"><span data-stu-id="b87a3-258">Open a Command Prompt on your local computer.</span></span>
    
2. <span data-ttu-id="b87a3-259">手順 4 で O365ImportTool.exe ツールをインストールしたディレクトリに移動する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-259">Go to the directory where you installed the O365ImportTool.exe tool in Step 4.</span></span>
    
3. <span data-ttu-id="b87a3-260">次のコマンドを実行して、PST ファイルを暗号化して Office 365 にアップロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-260">Run the following command to encrypt and upload PST files to Office 365.</span></span>
    
    ```powershell
    O365ImportTool.exe /srcdir:<Location of PST files> /protect-rmsserver:<RMS licensing location> /protect-tenantid:<BPOSId> /protect-key:<Symmetric key> /transfer:upload /upload-dest:<Network upload URL> /upload-destSAS:<SAS key>
    ```

    <span data-ttu-id="b87a3-261">次の表は、パラメーターとそれに必要な値を説明したものです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-261">The following table describes the parameters and their required values.</span></span> <span data-ttu-id="b87a3-262">前の手順で取得した情報は、これらのパラメーターの値で使用されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-262">The information you obtained in the previous steps is used in the values for these parameters.</span></span>
    
    |<span data-ttu-id="b87a3-263">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="b87a3-263">**Parameter**</span></span>|<span data-ttu-id="b87a3-264">**Description**</span><span class="sxs-lookup"><span data-stu-id="b87a3-264">**Description**</span></span>|<span data-ttu-id="b87a3-265">**例**</span><span class="sxs-lookup"><span data-stu-id="b87a3-265">**Example**</span></span>|
    |:-----|:-----|:-----|
    | `/srcdir:` <br/> |<span data-ttu-id="b87a3-266">Office 365 にアップロードする PST ファイルを含む組織内のソース ディレクトリを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-266">Specifies the source directory in your organization that contains the PST files that will be uploaded to Office 365.</span></span>  <br/> | `/srcdir:\\FILESERVER01\PSTs` <br/> |
    | `/protect-rmsserver:` <br/> |<span data-ttu-id="b87a3-267">Azure RMS サービスのライセンスの場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-267">Specifies the licensing location for your Azure RMS service.</span></span> <span data-ttu-id="b87a3-268">手順3で取得し`LicensingIntranetDistributionPointUrl`たプロパティの値を使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-268">Use the value of the  `LicensingIntranetDistributionPointUrl` property that you obtained in Step 3.</span></span> <span data-ttu-id="b87a3-269">このパラメーターの値は二重引用符 ("") で囲むようにしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-269">Be sure to surround the value of this parameter with double-quotation marks (" ")</span></span>  <br/> | `/protect-rmsserver:"https://afcbd8ec-cb2b-4a1a-8246-0b4bc22d1978.rms.na.aadrm.com/_wmcs/licensing"` <br/> |
    | `/protect-tenantid:` <br/> |<span data-ttu-id="b87a3-270">Azure RMS 組織の id を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-270">Specifies the identity of your Azure RMS organization.</span></span> <span data-ttu-id="b87a3-271">手順3で取得し`BPOSId`たプロパティの値を使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-271">Use the value of the  `BPOSId` property that you obtained in Step 3.</span></span>  <br/> | `/protect-tenantid:42745b33-2a5c-4726-8a2a-ca43caa0f74b` <br/> |
    | `/protect-key:` <br/> |<span data-ttu-id="b87a3-272">手順 2 で取得した対称キーを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-272">Specifies the symmetric key that you obtained in Step 2.</span></span> <span data-ttu-id="b87a3-273">このパラメーターの値は必ず二重引用符 (" ") で囲むようにしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-273">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span>  <br/> | `/protect-key:"l+R+Umc5RGmSBh1oW+DoyMxm/h5h2JJXFcNOFiNp867="` <br/> |
    | `/transfer:` <br/> |PST ファイルをネットワーク経由でアップロードするか、またはハード ドライブで送付するかを指定します。 この値`upload`は、ネットワーク経由でファイルをアップロードしていることを示します。 <span data-ttu-id="b87a3-276">この値`drive`は、ハードドライブに pst を配布することを示します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-276">The value  `drive` indicates that you are shipping the PSTs on a hard drive.</span></span>  <br/> | `/transfer:upload` <br/> |
    | `/upload-dest:` <br/> |<span data-ttu-id="b87a3-277">PST ファイルのアップロード先となる Office 365 の送信先を指定します。これは、組織の Azure ストレージの場所です。</span><span class="sxs-lookup"><span data-stu-id="b87a3-277">Specifies the destination in Office 365 where your PST files will be uploaded to; this is the Azure Storage location for your organization.</span></span> <span data-ttu-id="b87a3-278">このパラメーターの値は、手順4でコピーした SAS URL からのネットワークアップロード URL で構成されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-278">The value for this parameter consists of the network upload URL from the SAS URL that you copied in Step 4.</span></span> <span data-ttu-id="b87a3-279">このパラメーターの値は必ず二重引用符 (" ") で囲むようにしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-279">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span>  <br/><br/> <span data-ttu-id="b87a3-280">**ヒント:** (オプション) 暗号化された PST ファイルをアップロードするために、Azure ストレージの場所にサブフォルダーを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-280">**Tip:** (Optional) You can specify a subfolder in the Azure Storage location to upload the encrypted PST files to.</span></span> <span data-ttu-id="b87a3-281">これを行うには、ネットワークアップロード URL にサブフォルダーの場所 ("ingestiondata" の後) を追加します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-281">You do this by adding a subfolder location (after "ingestiondata") in the network upload URL.</span></span> <span data-ttu-id="b87a3-282">最初の例では、サブフォルダーを指定しません。これは、Pst が Azure ストレージの場所のルート ( *ingestiondata*という名前) にアップロードされることを意味します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-282">The first example doesn't specify a subfolder; that means the PSTs will be uploaded to the root (named  *ingestiondata*) of the Azure Storage location.</span></span> <span data-ttu-id="b87a3-283">2番目の例では、PST ファイルを Azure ストレージの場所のサブフォルダー ( *encryptedpsts*という名前) にアップロードします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-283">The second example uploads the PST files to a subfolder (named  *EncryptedPSTs*) in the Azure Storage location.</span></span>           | `/upload-dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata"` <br/> <span data-ttu-id="b87a3-284">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-284">Or</span></span>  <br/>  `/upload-dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/EncryptedPSTs"` <br/> |
    | `/upload-destSAS:` <br/> |<span data-ttu-id="b87a3-285">組織の SAS キーを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-285">Specifies the SAS key for your organization.</span></span> <span data-ttu-id="b87a3-286">このパラメーターの値は、手順4でコピーした SAS URL の SAS キーで構成されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-286">The value for this parameter consists of the SAS key from the SAS URL that you copied in Step 4.</span></span> <span data-ttu-id="b87a3-287">SAS キーの最初の文字は疑問符 ("?") です。</span><span class="sxs-lookup"><span data-stu-id="b87a3-287">The first character in the SAS key is a question mark ("?").</span></span> <span data-ttu-id="b87a3-288">このパラメーターの値は必ず二重引用符 (" ") で囲むようにしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-288">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span><br/><br/><span data-ttu-id="b87a3-289">**注:** スクリプトまたはバッチファイルで SAS URL を使用する場合は、エスケープする必要のある文字について注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-289">**Note:** If you use the SAS URL in a script or batch file, you need to watch out for certain characters that need to be escaped.</span></span> <span data-ttu-id="b87a3-290">たとえば`%` 、に変更`%%`してに`&` `^&`変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-290">For example, you have to change `%` to `%%` and change `&` to `^&`.</span></span> | `/upload-destSAS:"?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"` <br/> |
    | `/recurse` <br/> |<span data-ttu-id="b87a3-291">このオプションスイッチは、O365importtool.zip ツールが`/srcdir:`パラメーターで指定されたソースディレクトリ内のサブフォルダーにある PST ファイルをコピーするように、再帰モードを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-291">This optional switch specifies the recursive mode so that the O365ImportTool.exe tool will copy PST files that are located in subfolders in the source directory that is specified by the  `/srcdir:` parameter.</span></span>  <br/><br/> <span data-ttu-id="b87a3-292">**注:** このスイッチを含めると、サブフォルダー内の PST ファイルには、アップロード後、Azure Storage の場所に別のファイルのパス名が指定されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-292">**Note:** If you include this switch, PST files in subfolders will have a different file pathname in the Azure Storage location after they're uploaded.</span></span> <span data-ttu-id="b87a3-293">手順 7 で作成した CSV ファイルの正確なファイルのパス名を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-293">You'll have to specify the exact file pathname in the CSV file that you create in Step 7.</span></span>           | `/recurse` <br/> |
   
    <span data-ttu-id="b87a3-294">各パラメーターの実際の値を使用する O365ImportTool.exe ツールの構文の例を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-294">Here's an example of the syntax for the O365ImportTool.exe tool using actual values for each parameter:</span></span>
    
    ```powershell
    O365ImportTool.exe /srcdir:\\FILESERVER01\PSTs /protect-rmsserver:"https://afcbd8ec-cb2b-4a1a-8246-0b4bc22d1978.rms.na.aadrm.com/_wmcs/licensing" /protect-tenantid:42745b33-2a5c-4726-8a2a-ca43caa0f74b  /protect-key:"l+R+Umc5RGmSBh1oW+DoyMxm/h5h2JJXFcNOFiNp867=" /transfer:upload /upload-dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata" /upload-destSAS:"?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"
    ```

    <span data-ttu-id="b87a3-p138">コマンドを実行すると、PST ファイルの暗号化とアップロードの進行状況を示す状態メッセージが表示されます。最終の状態メッセージは、暗号化とアップロードが正常に完了したファイルの合計数を示しています。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-p138">After you run the command, status messages are displayed that show the progress of encrypting and uploading the PST files. A final status message shows the total number of files that were successfully encrypted and uploaded.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="b87a3-297">O365ImportTool コマンドを正常に実行して、すべてのパラメーターが正しいことを確認した後、コマンド ライン構文のコピーを、前の手順で取得した情報をコピーしたファイルと同じ (セキュリティで保護された) ファイルに保存します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-297">After you successfully run the O365ImportTool.exe command and verify that all the parameters are correct, save a copy of the command line syntax to the same (secured) file where you copied the information you obtained in the previous steps.</span></span> <span data-ttu-id="b87a3-298">次に、O365importtool.zip ツールを実行して PST ファイルを暗号化して Office 365 にアップロードするたびに、このコマンドをコマンドプロンプトにコピーして貼り付けることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-298">Then you can copy and paste this command in a Command Prompt each time that you want to run the O365ImportTool.exe tool to encrypt and upload PST files to Office 365.</span></span> <span data-ttu-id="b87a3-299">変更する必要があるのは、パラメーター `/srcdir:`と`/upload-dest:`パラメーターの値だけです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-299">The only values you might have to change are the ones for the  `/srcdir:` and  `/upload-dest:` parameters.</span></span> 
  
## <a name="optional-step-6-view-a-list-of-the-pst-files-uploaded-to-office-365"></a><span data-ttu-id="b87a3-300">オプション手順 6: Office 365 にアップロードされた PST ファイルの一覧を表示する</span><span class="sxs-lookup"><span data-stu-id="b87a3-300">(Optional) Step 6: View a list of the PST files uploaded to Office 365</span></span>

<span data-ttu-id="b87a3-301">オプションの手順として、Microsoft Azure ストレージエクスプローラー (無償のオープンソースツール) をインストールして使用し、Azure blob にアップロードした PST ファイルの一覧を表示することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-301">As an optional step, you can install and use the Microsoft Azure Storage Explorer (which is a free, open source tool) to view the list of the PST files that you've uploaded to the Azure blob.</span></span> <span data-ttu-id="b87a3-302">これを行うには、次の3つの適切な理由があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-302">There are three good reasons to do this:</span></span>
  
- <span data-ttu-id="b87a3-303">共有フォルダーまたは組織内のファイル サーバーから PST ファイルが Azure BLOB に正常にアップロードされたことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-303">Verify that PST files from the shared folder or file server in your organization were successfully uploaded to the Azure blob.</span></span>

- <span data-ttu-id="b87a3-304">PST ファイルが暗号化されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-304">Verify that the PST files are encrypted.</span></span> <span data-ttu-id="b87a3-305">暗号化された PST `.pfile`ファイルには、pst ファイル名に拡張子が付いています。たとえば、 `pilarp.pst.pfile`のようになります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-305">Encrypted PST files have a  `.pfile` extension appended to the PST filename; for example,  `pilarp.pst.pfile`.</span></span>
    
- <span data-ttu-id="b87a3-306">各 PST ファイルのファイル名 (およびファイル名が含まれている場合はサブフォルダーのパス名) が Azure BLOB にアップロードされたことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-306">Verify the filename (and the subfolder pathname if you included one) for each PST file uploaded to the Azure blob.</span></span> <span data-ttu-id="b87a3-307">次の手順で PST マッピング ファイルを作成する際、各 PST ファイルに対しファイル名とフォルダーのパス名の両方を指定する必要があるため、この機能は便利です。</span><span class="sxs-lookup"><span data-stu-id="b87a3-307">This is helpful when you're creating the PST mapping file in the next step because you have to specify both the folder pathname and filename for each PST file.</span></span> <span data-ttu-id="b87a3-308">この名前を確認すると、PST マッピング ファイル内の潜在的なエラーを削減できます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-308">Verifying these names can help reduce potential errors in your PST mapping file.</span></span>
    
<span data-ttu-id="b87a3-309">Microsoft Azure Storage Explorer はプレビュー中です。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-309">The Microsoft Azure Storage Explorer is in Preview.</span></span> 
  
 > [!IMPORTANT]
>  <span data-ttu-id="b87a3-310">Azure Storage Explorer で PST ファイルをアップロードまたは変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-310">You can't use the Azure Storage Explorer to upload or modify PST files.</span></span> <span data-ttu-id="b87a3-311">PST ファイルを Office 365 にインポートするには、AzCopy を使用する方法のみがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="b87a3-311">The only supported method for importing PST files to Office 365 is to use AzCopy.</span></span> <span data-ttu-id="b87a3-312">また、Azure BLOB にアップロードした PST ファイルを削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-312">Also, you can't delete PST files that you've uploaded to the Azure blob.</span></span> <span data-ttu-id="b87a3-313">PST ファイルを削除しようとすると、必要なアクセス許可がないというエラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-313">If you try to delete a PST file, you'll receive an error about not having the required permissions.</span></span> <span data-ttu-id="b87a3-314">なお、すべての PST ファイルは Azure 記憶域から自動的に削除されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-314">Note that all PST files are automatically deleted from your Azure storage area.</span></span> <span data-ttu-id="b87a3-315">進捗中のインポート ジョブがない場合、一番新しいインポート ジョブの作成から 30 日後に **ingestiondata** コンテナーのすべての PST ファイルが削除されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-315">If there are no import jobs in progress, then all PST files in the **ingestiondata** container are deleted 30 days after the most recent import job was created.</span></span> 
  
<span data-ttu-id="b87a3-316">Azure Storage Explorer をインストールし、Azure Storage 領域に接続するには:</span><span class="sxs-lookup"><span data-stu-id="b87a3-316">To install the Azure Storage Explorer and connect to your Azure Storage area:</span></span>
  
1. <span data-ttu-id="b87a3-317">[Microsoft Azure Storage Explorer ツール](https://go.microsoft.com/fwlink/p/?LinkId=544842)をダウンロードしてインストールします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-317">Download and install the [Microsoft Azure Storage Explorer tool](https://go.microsoft.com/fwlink/p/?LinkId=544842).</span></span>
    
2. <span data-ttu-id="b87a3-318">Microsoft Azure Storage Explorer を起動し、左側のウィンドウで [**ストレージ アカウント**] を右クリックして、[**Azure Storage に接続**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-318">Start the Microsoft Azure Storage Explorer, right-click **Storage Accounts** in the left pane, and then click **Connect to Azure Storage**.</span></span> 
    
    ![[ストレージ アカウント] を右クリックし、[Azure Storage に接続] をクリックします。](media/75b80cc3-c336-4f96-ad32-54ac9b96a7af.png)
  
3. <span data-ttu-id="b87a3-320">[ **Azure ストレージへの接続**] のボックスで、手順4で取得した SAS URL を貼り付けて、[**次へ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-320">In the box under **Connect to Azure Storage**, paste the SAS URL that you obtained in Step 4, and then click **Next**.</span></span> 
    
    ![[Azure Storage への接続] ページのボックスに、SAS URL を貼り付けます。](media/5d034128-e087-48e1-9ebc-4c9fa262d5b7.png)
  
4. <span data-ttu-id="b87a3-322">[**接続の概要**] ページで、接続情報を確認して [**接続**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-322">On the **Connection summary** page, you can review the connection information, and then click **Connect**.</span></span> 
    
5. <span data-ttu-id="b87a3-323">[**ストレージアカウント**] の下にある **(サービス SAS)** ノードを展開し、[ **Blob コンテナー** ] ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-323">Under **Storage Accounts**, expand the **(Service SAS)** node, and then expand the **Blob Containers** node.</span></span> 
    
6. <span data-ttu-id="b87a3-324">[ **Ingestiondata**] を右クリックし、[ **Blob コンテナーエディターを開く**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-324">Right-click **ingestiondata**, and then click **Open Blob Container Editor**.</span></span>
    
    ![ingestiondata を右クリックし、[Blob コンテナー エディターを開く] をクリックする](media/f50eee30-9202-4efc-904a-2895a0bc388d.png)
  
    <span data-ttu-id="b87a3-326">手順5でアップロードした PST ファイルの一覧を含む Azure ストレージ領域が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-326">The Azure Storage area, with a list of the PST files that you uploaded in Step 5 is displayed.</span></span>
    
    ![Azure Storage Explorer には、アップロードした PST ファイルのリストが表示されます。](media/a448ae43-e744-4153-8304-22b59e93883c.png)
  
7. <span data-ttu-id="b87a3-328">Microsoft Azure Storage Explorer の使用が完了したら、**ingestiondata** を右クリックし、[**デタッチ**] をクリックすると Azure Storage 領域から切断されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-328">When you're finished using the Microsoft Azure Storage Explorer, right-click **ingestiondata**, and then click **Detach** to disconnect from your Azure Storage area.</span></span> <span data-ttu-id="b87a3-329">切断しない場合、次に接続しようとするとエラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-329">Otherwise, you'll receive an error the next time you try to attach.</span></span> 
    
    ![ingestion を右クリックして [デタッチ] をクリックし、Azure Storage 領域から切断します。](media/1e8e5e95-4215-4ce4-a13d-ab5f826a0510.png)
  
## <a name="step-7-create-the-pst-import-mapping-file"></a><span data-ttu-id="b87a3-331">手順 7: PST インポートのマッピングファイルを作成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-331">Step 7: Create the PST Import mapping file</span></span>

<span data-ttu-id="b87a3-332">PST ファイルが暗号化され、Office 365 組織の Azure ストレージの場所にアップロードされた後、次の手順では、PST ファイルをインポートするユーザーのメールボックスを指定するコンマ区切り値 (CSV) ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-332">After the PST files have been encrypted and uploaded to the Azure Storage location for your Office 365 organization, the next step is to create a comma-separated value (CSV) file that specifies which user mailboxes the PST files will be imported to.</span></span> <span data-ttu-id="b87a3-333">PST インポート ジョブを作成する場合は、次の手順でこの CSV ファイルを送信します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-333">You will submit this CSV file in the next step when you create a PST Import job.</span></span>
  
1. <span data-ttu-id="b87a3-334">[PST インポート マッピング ファイルのコピーをダウンロードします](https://go.microsoft.com/fwlink/p/?LinkId=544717)。</span><span class="sxs-lookup"><span data-stu-id="b87a3-334">[Download a copy of the PST Import mapping file](https://go.microsoft.com/fwlink/p/?LinkId=544717).</span></span> 
    
2. <span data-ttu-id="b87a3-p146">CSV ファイルを開くか、ローカル コンピューターに保存します。次の例は、完了した PST インポートのマッピング ファイル (メモ帳で開いた) を示しています。Microsoft Excel を使って CSV ファイルを編集するほうが、はるかに簡単です。</span><span class="sxs-lookup"><span data-stu-id="b87a3-p146">Open or save the CSV file to your local computer. The following example shows a completed PST Import mapping file (opened in NotePad). It's much easier to use Microsoft Excel to edit the CSV file.</span></span>
    
    ```text
    Workload,FilePath,Name,Mailbox,IsArchive,TargetRootFolder,ContentCodePage,SPFileContainer,SPManifestContainer,SPSiteUrl
    Exchange,,annb.pst.pfile,annb@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,annb_archive.pst.pfile,annb@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,,donh.pst.pfile,donh@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,donh_archive.pst.pfile,donh@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,EncryptedPSTs,pilarp.pst.pfile,pilarp@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,EncryptedPSTs,pilarp_archive.pst.pfile,pilarp@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,EncryptedPSTs,tonyk.pst.pfile,tonyk@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,EncryptedPSTs,tonyk_archive.pst.pfile,tonyk@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,EncryptedPSTs,zrinkam.pst.pfile,zrinkam@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,EncryptedPSTs,zrinkam_archive.pst.pfile,zrinkam@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    ```

    <span data-ttu-id="b87a3-338">CSV ファイルの先頭行やヘッダー行には、PST ファイルをユーザー メールボックスにインポートするために PST インポート サービスで使うパラメーターが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-338">The first row, or header row, of the CSV file lists the parameters that will be used by the PST Import service to import the PST files to user mailboxes.</span></span> <span data-ttu-id="b87a3-339">各パラメーター名はコンマで区切られています。</span><span class="sxs-lookup"><span data-stu-id="b87a3-339">Each parameter name is separated by a comma.</span></span> <span data-ttu-id="b87a3-340">ヘッダー行の下の各行は、特定のメールボックスに PST ファイルをインポートするためのパラメーター値を表します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-340">Each row under the header row represents the parameter values for importing a PST file to a specific mailbox.</span></span> <span data-ttu-id="b87a3-341">ユーザー メールボックスにインポートする PST ファイルごとに行が必要になります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-341">You will need a row for each PST file that you want to import to a user mailbox.</span></span> <span data-ttu-id="b87a3-342">必ずマッピング ファイル内のプレースホルダーのデータを実際のデータに置き換えてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-342">Be sure to replace the placeholder data in the mapping file with your actual data.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="b87a3-343">SharePoint パラメーターなど、ヘッダー行は何も変更しないでください。これらは PST インポートの処理中、無視されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-343">Don't change anything in the header row, including the SharePoint parameters; they will be ignored during the PST Import process.</span></span> 
  
3. <span data-ttu-id="b87a3-344">次の表の情報を使って、必要な情報を含む CSV ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-344">Use the information in the following table to populate the CSV file with the required information.</span></span>
    
    |<span data-ttu-id="b87a3-345">**パラメーター**</span><span class="sxs-lookup"><span data-stu-id="b87a3-345">**Parameter**</span></span>|<span data-ttu-id="b87a3-346">**Description**</span><span class="sxs-lookup"><span data-stu-id="b87a3-346">**Description**</span></span>|<span data-ttu-id="b87a3-347">**例**</span><span class="sxs-lookup"><span data-stu-id="b87a3-347">**Example**</span></span>|
    |:-----|:-----|:-----|
    | `Workload` <br/> |<span data-ttu-id="b87a3-348">データのインポート先の Office 365 サービスを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-348">Specifies the Office 365 service that data will be imported to.</span></span> <span data-ttu-id="b87a3-349">ユーザー メールボックスに PST ファイルをインポートするには、`Exchange` を使用します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-349">To import PST files to user mailboxes, use  `Exchange`.</span></span>  <br/> | `Exchange` <br/> |
    | `FilePath` <br/> |<span data-ttu-id="b87a3-350">手順5で PST ファイルをアップロードした Azure ストレージの場所でのフォルダーの場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-350">Specifies the folder location in the Azure Storage location that you uploaded the PST files to in Step 5.</span></span>  <br/>  <span data-ttu-id="b87a3-351">手順5の`/upload-dest:`パラメーターに、ネットワーク URL にオプションのサブフォルダー名を含めなかった場合は、CSV ファイルでこのパラメーターを空白のままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-351">If you didn't include an optional subfolder name in the network URL in the  `/upload-dest:` parameter in Step 5, leave this parameter blank in the CSV file.</span></span> <span data-ttu-id="b87a3-352">サブフォルダー名を含める場合は、このパラメーターで指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-352">If you included a subfolder name, specify it in this parameter.</span></span> <span data-ttu-id="b87a3-353">このパラメーターの値には、大文字と小文字の区別があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-353">The value for this parameter is case-sensitive.</span></span> <span data-ttu-id="b87a3-354">どちらの場合でも、`FilePath` パラメーターの値に "ingestiondata" を含め*ない*でください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-354">Either way,  *don't*  include "ingestiondata" in the value for the  `FilePath` parameter.</span></span>  <br/> <br/><span data-ttu-id="b87a3-355">**重要:** ファイルパス名の大文字と小文字は、手順5で`/upload-dest:`パラメーターの SAS URL にオプションのサブフォルダ名を含めた場合に使用したものと同じである必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-355">**Important:** The case for the file path name must be the same case that you used if you included an optional subfolder name in the SAS URL in the  `/upload-dest:` parameter in Step 5.</span></span> <span data-ttu-id="b87a3-356">たとえば、手順5でサブ`EncryptedPSTs`フォルダー名を使用し、CSV ファイルの`encryptedpsts` `FilePath`パラメーターでを使用した場合、PST ファイルのインポートは失敗します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-356">For example, if you used  `EncryptedPSTs` for the subfolder name in Step 5 and then use  `encryptedpsts` in the  `FilePath` parameter in CSV file, the import for the PST file will fail.</span></span> <span data-ttu-id="b87a3-357">必ず、両方のインスタンスの大文字と小文字を同じにしてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-357">Be sure to use the same case in both instances.</span></span>           |<span data-ttu-id="b87a3-358">(空白のまま)</span><span class="sxs-lookup"><span data-stu-id="b87a3-358">(leave blank)</span></span>  <br/> <span data-ttu-id="b87a3-359">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-359">Or</span></span>  <br/>  `EncryptedPSTs` <br/> |
    | `Name` <br/> |<span data-ttu-id="b87a3-360">ユーザー メールボックスにインポートする PST ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-360">Specifies the name of the PST file that will be imported to the user mailbox.</span></span> <span data-ttu-id="b87a3-361">このパラメーターの値には、大文字と小文字の区別があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-361">The value for this parameter is case-sensitive.</span></span> <span data-ttu-id="b87a3-362">Azure ストレージの場所にアップロードされる PST ファイルは暗号化されるため、 `.pfile` pst ファイル名に拡張子が追加されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-362">Because the PST files that are uploaded to the Azure Storage location are encrypted, a  `.pfile` extension is added to the PST filename.</span></span> <span data-ttu-id="b87a3-363">CSV ファイルの PST `.pfile`ファイルの名前に拡張機能を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-363">You must add the  `.pfile` extension to the name of the PST files in the CSV file.</span></span>  <br/><br/> <span data-ttu-id="b87a3-364">**重要:** CSV ファイルの PST ファイル名の大文字と小文字は、手順5で Azure ストレージの場所にアップロードされた PST ファイルと同じである必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-364">**Important:** The case for the PST file name in the CSV file must be the same as the PST file that was uploaded to the Azure Storage location in Step 5.</span></span> <span data-ttu-id="b87a3-365">たとえば、CSV ファイル内の `Name` パラメーターでは `annb.pst.pfile` を使用していますが、実際の PST ファイルの名前は `AnnB.pst` である場合、その PST ファイルのインポートは失敗します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-365">For example, if you use  `annb.pst.pfile` in the  `Name` parameter in the CSV file, but the name of the actual PST file is  `AnnB.pst`, the import for that PST file will fail.</span></span> <span data-ttu-id="b87a3-366">CSV ファイル内の PST の名前の大文字小文字は、実際の PST ファイルの場合と同じである必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-366">Be sure that the name of the PST in the CSV file uses the same case as the actual PST file.</span></span>           | `annb.pst.pfile` <br/> |
    | `Mailbox` <br/> |<span data-ttu-id="b87a3-367">PST ファイルのインポート先になるメールボックスのメールアドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-367">Specifies the email address of the mailbox that the PST file will be imported to.</span></span>  <br/> <span data-ttu-id="b87a3-368">PST ファイルを非アクティブなメールボックスにインポートするには、このパラメーターにメールボックスの GUID を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-368">To import a PST file to an inactive mailbox, you have to specify the mailbox GUID for this parameter.</span></span> <span data-ttu-id="b87a3-369">この GUID を取得するには、Exchange Online で `Get-Mailbox -InactiveMailboxOnly <identity of inactive mailbox> | FL Guid` の PowerShell コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-369">To obtain this GUID, run the following PowerShell command in Exchange Online:  `Get-Mailbox -InactiveMailboxOnly <identity of inactive mailbox> | FL Guid`</span></span> <br/><br/> <span data-ttu-id="b87a3-370">**注:** 場合によっては、1つのメールボックスがアクティブなメールボックスであり、もう一方のメールボックスが削除済み (非アクティブ) 状態になっているメールボックスが同じメールアドレスを持つ複数のメールボックスが存在することがあります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-370">**Note:** In some cases, you might have multiple mailboxes with the same email address, where one mailbox is an active mailbox and the other mailbox is in a soft-deleted (or inactive) state.</span></span> <span data-ttu-id="b87a3-371">このような状況で、PST ファイルのインポート先のメールボックスを一意に識別するには、メールボックスの GUID を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-371">In these situations, you have to specify the mailbox GUID to uniquely identify the mailbox to import the PST file to.</span></span> <span data-ttu-id="b87a3-372">アクティブなメールボックスの GUID を取得するには、次の PowerShell コマンドを実行します: `Get-Mailbox - <identity of active mailbox> | FL Guid`</span><span class="sxs-lookup"><span data-stu-id="b87a3-372">To obtain this GUID for active mailboxes, run the following PowerShell command:  `Get-Mailbox - <identity of active mailbox> | FL Guid`.</span></span> <span data-ttu-id="b87a3-373">回復可能な削除 (または非アクティブ) のメールボックスの GUID を取得するには、次のコマンドを実行します。`Get-Mailbox - <identity of soft-deleted or inactive mailbox> -SoftDeletedMailbox | FL Guid`</span><span class="sxs-lookup"><span data-stu-id="b87a3-373">To obtain the GUID for soft-deleted (or inactive) mailboxes, run this command  `Get-Mailbox - <identity of soft-deleted or inactive mailbox> -SoftDeletedMailbox | FL Guid`</span></span>           | `annb@contoso.onmicrosoft.com` <br/> <span data-ttu-id="b87a3-374">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-374">Or</span></span>  <br/>  `2d7a87fe-d6a2-40cc-8aff-1ebea80d4ae7` <br/> |
    | `IsArchive` <br/> | <span data-ttu-id="b87a3-375">PST ファイルをユーザーのアーカイブ メールボックスにインポートするかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-375">Specifies whether or not to import the PST file to the user's archive mailbox.</span></span> <span data-ttu-id="b87a3-376">次のような 2 つの選択肢があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-376">There are two options:</span></span>  <br/> <span data-ttu-id="b87a3-377">**FALSE**PST ファイルをユーザーのプライマリメールボックスにインポートします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-377">**FALSE** Imports the PST file to the user's primary mailbox.</span></span>  <br/> <span data-ttu-id="b87a3-378">**TRUE**PST ファイルをユーザーのアーカイブメールボックスにインポートします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-378">**TRUE** Imports the PST file to the user's archive mailbox.</span></span>  <br/>  <span data-ttu-id="b87a3-379">このパラメーターを空白のままにすると、PST ファイルはユーザーのプライマリ メールボックスにインポートされます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-379">If you leave this parameter blank, the PST file is imported to the user's primary mailbox.</span></span>  <br/><br/> <span data-ttu-id="b87a3-380">**注:** プライマリメールボックスがオンプレミスであるユーザーのクラウドベースのアーカイブメールボックスに PST ファイルをインポートするには、このパラメーターに**TRUE**を指定し、 `Mailbox`パラメーターのユーザーの社内メールボックスの電子メールアドレスを指定するだけです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-380">**Note:** To import a PST file to a cloud-based archive mailbox for a user whose primary mailbox is on-premises, just specify **TRUE** for this parameter and specify the email address for the user's on-premises mailbox for the  `Mailbox` parameter.</span></span>           | `FALSE` <br/> <span data-ttu-id="b87a3-381">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-381">Or</span></span>  <br/>  `TRUE` <br/> |
    | `TargetRootFolder` <br/> | <span data-ttu-id="b87a3-382">PST ファイルのインポート先のメールボックス フォルダーを指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-382">Specifies the mailbox folder that the PST file is imported to.</span></span>  <br/>  <span data-ttu-id="b87a3-383">このパラメーターを空白のままにした場合、PST はメールボックスのルートレベル (受信トレイフォルダーとその他の既定のメールボックスフォルダーと同じレベル) にある**インポート**された新しいフォルダーにインポートされます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-383">If you leave this parameter blank, the PST will be imported to a new folder named **Imported** located at the root level of the mailbox (the same level as the Inbox folder and the other default mailbox folders).</span></span>  <br/>  <span data-ttu-id="b87a3-384">を指定`/`した場合、PST ファイル内のアイテムは、ユーザーの受信トレイフォルダーに直接インポートされます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-384">If you specify  `/`, items in the PST file will be imported directly in to the user's Inbox folder.</span></span>  <br/>  <span data-ttu-id="b87a3-385">を指定`/<foldername>`した場合、PST ファイルのアイテムは、 \* \<foldername\> \*という名前のサブフォルダーにインポートされます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-385">If you specify  `/<foldername>`, items in the PST file will be imported to a subfolder named  *\<foldername\>*  .</span></span> <span data-ttu-id="b87a3-386">たとえば、を使用`/ImportedPst`した場合、アイテムは**ImportedPst**という名前のサブフォルダーにインポートされます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-386">For example, if you used  `/ImportedPst`, items would be imported to a subfolder named **ImportedPst**.</span></span> <span data-ttu-id="b87a3-387">このサブフォルダーは、ユーザーの受信トレイフォルダーに配置されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-387">This subfolder will be located in the user's Inbox folder.</span></span>  <br/><br/> <span data-ttu-id="b87a3-388">**ヒント:** PST ファイルのインポートに最適なフォルダーの場所を決定できるように、いくつかのテストバッチを実行して、このパラメーターを試してみることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-388">**Tip:** Consider running a few test batches to experiment with this parameter so you can determine the best folder location to import PST files to.</span></span>           |<span data-ttu-id="b87a3-389">(空白のまま)</span><span class="sxs-lookup"><span data-stu-id="b87a3-389">(leave blank)</span></span>  <br/> <span data-ttu-id="b87a3-390">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-390">Or</span></span>  <br/>  `/` <br/> <span data-ttu-id="b87a3-391">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-391">Or</span></span>  <br/>  `/ImportedPst` <br/> |
    | `ContentCodePage` <br/> |<span data-ttu-id="b87a3-392">この省略可能なパラメーターでは、PST ファイルを ANSI ファイル形式でインポートする場合に使用するコード ページの数値を指定します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-392">This optional parameter specifies a numeric value for the code page to use for importing PST files in the ANSI file format.</span></span> <span data-ttu-id="b87a3-393">このパラメーターは、中国語、日本語、韓国語 (CJK) を使用する組織から PST ファイルをインポートする場合に使用します。通常、これらの言語は、文字エンコードのために 2 バイト文字セット (DBCS) を使用するからです。</span><span class="sxs-lookup"><span data-stu-id="b87a3-393">This parameter is used for importing PST files from Chinese, Japanese, and Korean (CJK) organizations because these languages typically use a double byte character set (DBCS) for character encoding.</span></span> <span data-ttu-id="b87a3-394">メールボックス フォルダー名に DBCS が使用されている言語については、PST ファイルのインポートの際にこのパラメーターを使用しないと、多くの場合、インポート後にフォルダー名の文字化けが発生します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-394">If this parameter isn't used to import PST files for languages that use DBCS for mailbox folder names, the folder names are often garbled after they're imported.</span></span> <span data-ttu-id="b87a3-395">このパラメーターに使用できる値のリストについては、「[Code Page Identifiers](https://go.microsoft.com/fwlink/p/?LinkId=328514)」 (コード ページ識別子) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-395">For a list of supported values to use for this parameter, see [Code Page Identifiers](https://go.microsoft.com/fwlink/p/?LinkId=328514).</span></span>  <br/><br/> <span data-ttu-id="b87a3-396">\*\*注: \*\*前述したように、これは省略可能なパラメーターであり、CSV ファイルに含めなくてもかまいません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-396">**Note:** As previously stated, this is an optional parameter and you don't have to include it in the CSV file.</span></span> <span data-ttu-id="b87a3-397">または、このパラメーターを含め、1 つまたは複数の行について値を空白のままにしておくこともできます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-397">Or you can include it and leave the value blank for one or more rows.</span></span>           |<span data-ttu-id="b87a3-398">(空白のまま)</span><span class="sxs-lookup"><span data-stu-id="b87a3-398">(leave blank)</span></span>  <br/> <span data-ttu-id="b87a3-399">または</span><span class="sxs-lookup"><span data-stu-id="b87a3-399">Or</span></span>  <br/>  <span data-ttu-id="b87a3-400">`932` (ANSI/OEM 日本語のコード ページ ID)</span><span class="sxs-lookup"><span data-stu-id="b87a3-400">`932` (which is the code page identifier for ANSI/OEM Japanese)</span></span>  <br/> |
    | `SPFileContainer` <br/> |<span data-ttu-id="b87a3-401">PST インポートの場合は、このパラメーターを空白のままにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-401">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="b87a3-402">該当なし</span><span class="sxs-lookup"><span data-stu-id="b87a3-402">Not applicable</span></span>  <br/> |
    | `SPManifestContainer` <br/> |<span data-ttu-id="b87a3-403">PST インポートの場合は、このパラメーターを空白のままにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-403">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="b87a3-404">該当なし</span><span class="sxs-lookup"><span data-stu-id="b87a3-404">Not applicable</span></span>  <br/> |
    | `SPSiteUrl` <br/> |<span data-ttu-id="b87a3-405">PST インポートの場合は、このパラメーターを空白のままにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-405">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="b87a3-406">該当なし</span><span class="sxs-lookup"><span data-stu-id="b87a3-406">Not applicable</span></span>  <br/> |
  
## <a name="step-8-create-a-pst-import-job-in-office-365"></a><span data-ttu-id="b87a3-407">手順 8:Office 365 で PST インポート ジョブを作成する</span><span class="sxs-lookup"><span data-stu-id="b87a3-407">Step 8: Create a PST Import job in Office 365</span></span>

<span data-ttu-id="b87a3-408">最後の手順では、Office 365 のインポートサービスで PST インポートジョブを作成します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-408">The last step is to create the PST Import job in the Import service in Office 365.</span></span> <span data-ttu-id="b87a3-409">前述したように、手順 7 で作成した PST インポートのマッピング ファイルを送信します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-409">As previously explained, you will submit the PST Import mapping file that you created in Step 7.</span></span> <span data-ttu-id="b87a3-410">新しいジョブを作成した後、インポートサービスはマッピングファイルの情報を使用して、その PST ファイル (手順5で Office 365 にアップロードしたもの) を、指定されたユーザーメールボックスに暗号化解除してインポートします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-410">After you create the new job, the Import service will use the information in the mapping file to unencrypt and import the PST files (that you uploaded to Office 365 in Step 5) to the specified user mailbox.</span></span> 
  
1. <span data-ttu-id="b87a3-411">[https://protection.office.com](https://protection.office.com) に移動します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-411">Go to [https://protection.office.com](https://protection.office.com).</span></span>
    
2. <span data-ttu-id="b87a3-412">Office 365 組織の管理者アカウントの資格情報を使用して、Office 365 にサインインします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-412">Sign in to Office 365 using the credentials for an administrator account in your Office 365 organization.</span></span>
    
3. <span data-ttu-id="b87a3-413">左側のウィンドウで、[ **Information ガバナンス > インポート > インポート**] をクリックして、PST ファイルをインポートします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-413">In the left pane, click **Information governance > Import > Import PST files**.</span></span>
    
4. <span data-ttu-id="b87a3-414">[ **PST ファイルのインポート**] ページで、[**インポートサービスに移動] を**クリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-414">On the **Import PST files** page, click **Go to the Import service**.</span></span>
    
5. <span data-ttu-id="b87a3-415">[ **Office へのデータのインポート 365** ] ページで、[**新しいジョブ**![の追加] アイコン](media/ITPro-EAC-AddIcon.gif)をクリックし、[**電子メールメッセージ (PST ファイル) のアップロード**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-415">On the **Import data to Office 365** page, click **New job**![Add Icon](media/ITPro-EAC-AddIcon.gif), and then click **Upload email messages (PST files)**.</span></span>
    
6. <span data-ttu-id="b87a3-416">**[ネットワーク経由でファイルをアップロードする]** ページで、**[ファイルのアップロードが完了しました]** と **[マッピング ファイルにアクセスできます]** の各チェック ボックスを選択して、**[次へ]** をクリックします。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-416">On the **Upload files over the network** page, click the **I'm done uploading my files** and **I have access to the mapping file** check boxes, and then click **Next**.</span></span> 
    
7. <span data-ttu-id="b87a3-417">PST インポート ジョブの名前を入力し、**[次へ]** をクリックする。</span><span class="sxs-lookup"><span data-stu-id="b87a3-417">Type a name for the PST Import job, and then click **Next**.</span></span>
    
8. <span data-ttu-id="b87a3-418">[追加] アイコン](media/ITPro-EAC-AddIcon.gif)をクリックして、手順7で作成した PST マッピングファイルを選択します。 \*\*\*\* ![</span><span class="sxs-lookup"><span data-stu-id="b87a3-418">Click **Add** ![Add Icon](media/ITPro-EAC-AddIcon.gif) to select the PST Mapping file that you created in Step 7.</span></span> 
    
9. <span data-ttu-id="b87a3-419">CSV ファイルの名前が一覧に表示されたら、**[検証]** をクリックして、CSV ファイルにエラーがないか確認する。 </span><span class="sxs-lookup"><span data-stu-id="b87a3-419">After the name of the CSV file appears in the list, select it and then click **Validate** to check your CSV file for errors.</span></span> 
    
    > [!NOTE]
    > <span data-ttu-id="b87a3-420">前述したように、PST ファイルが暗号化され`.pfile`ている場合は、pst ファイル名に拡張子が追加されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-420">As previous explained, when the PST files are encrypted, a  `.pfile` extension is appended to the PST filename.</span></span> <span data-ttu-id="b87a3-421">CSV ファイルの PST `.pfile`ファイルの名前に拡張機能を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-421">You must add the  `.pfile` extension to the name of the PST files in the CSV file.</span></span> <span data-ttu-id="b87a3-422">追加しないと、CSV ファイルの検証が失敗します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-422">If you don't, the validation of the CSV file will fail.</span></span> 
  
    <span data-ttu-id="b87a3-423">PST インポート ジョブを作成するには、CSV ファイルが正常に検証される必要があります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-423">The CSV file has to be successfully validated to create a PST Import job.</span></span> <span data-ttu-id="b87a3-424">検証が失敗した場合は、**[状態]** 列の **[無効]** リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-424">If the validation fails, click the **Invalid** link in the **Status** column.</span></span> <span data-ttu-id="b87a3-425">PST インポートマッピングファイルのコピーが開き、エラーが発生したファイル内の各行に対してエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-425">A copy of your PST Import mapping file is opened, with an error message for each row in the file that failed.</span></span> 
    
10. <span data-ttu-id="b87a3-426">PST のマッピング ファイルが正常に検証されたら、ご契約条件を読み、チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-426">When the PST mapping file is successfully validated, read the terms and conditions document, and then click the checkbox.</span></span>
    
11. <span data-ttu-id="b87a3-427">**[完了]** をクリックして、ジョブを送信します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-427">Click **Finish** to submit the job.</span></span> 
    
    <span data-ttu-id="b87a3-428">ジョブは、[**データを Office 365 にインポートする**] ページの PST インポートジョブの一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-428">The job is displayed in the list of PST Import jobs on the **Import data to Office 365** page.</span></span> 
    
12. <span data-ttu-id="b87a3-429">ジョブを選択し、 **[更新**![の](media/O365-MDM-Policy-RefreshIcon.gif)更新] アイコンをクリックして、詳細ウィンドウに表示される状態情報を更新します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-429">Select the job and click **Refresh**![Refresh icon](media/O365-MDM-Policy-RefreshIcon.gif) to update the status information that's displayed in the details pane.</span></span> 
    
13. <span data-ttu-id="b87a3-430">詳細ウィンドウで、**[詳細の表示]** をクリックして、選択したジョブの最新の状態を取得します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-430">In the details pane, click **View details** to get the latest status for the selected job.</span></span> 
 
## <a name="more-information"></a><span data-ttu-id="b87a3-431">詳細情報</span><span class="sxs-lookup"><span data-stu-id="b87a3-431">More information</span></span>

- <span data-ttu-id="b87a3-432">なぜ PST ファイルを Office 365 にインポートするのか?</span><span class="sxs-lookup"><span data-stu-id="b87a3-432">Why import PST files to Office 365?</span></span>
    
  - <span data-ttu-id="b87a3-433">組織の電子メールを Office 365 に移行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-433">It's a good way to migrate your organization's email to Office 365.</span></span>
    
  - <span data-ttu-id="b87a3-434">次のことが可能になるので、組織のコンプライアンスのニーズに対応するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-434">It helps address compliance needs of your organization by letting you:</span></span>
    
  - <span data-ttu-id="b87a3-435">アーカイブ メールボックスを有効にして、追加のメールボックス容量をユーザーに提供する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-435">Enable archive mailboxes to give users additional mailbox storage space.</span></span>
    
  - <span data-ttu-id="b87a3-436">メールボックスを保持状態にして、コンテンツを保持する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-436">Place mailboxes on hold to preserve content.</span></span>
    
  - <span data-ttu-id="b87a3-437">Microsoft 電子情報開示ツールを使って、メールボックスのコンテンツを検索する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-437">Use Microsoft eDiscovery tools to search for content in mailboxes.</span></span>
    
  - <span data-ttu-id="b87a3-438">アイテム保持ポリシーを使って、メールボックスのコンテンツの保持期間を制御する。</span><span class="sxs-lookup"><span data-stu-id="b87a3-438">Use retention policies to control how long mailbox content is retained.</span></span>
    
  - <span data-ttu-id="b87a3-439">メールボックス関連イベントに対して Office 365 監査ログを検索します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-439">Search the Office 365 audit log for mailbox-related events.</span></span>
    
  - <span data-ttu-id="b87a3-440">データ損失を防止するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-440">It helps protect against data loss.</span></span> <span data-ttu-id="b87a3-441">Office 365 メールボックスにインポートされる PST ファイルは、データをユーザーのコンピューターに保存するのではなく、Exchange Online の高可用性機能を継承します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-441">PST files that are imported to Office 365 mailboxes inherit the high availability features of Exchange Online, as opposed to storing the data on a user's computer.</span></span>
    
  - <span data-ttu-id="b87a3-442">データがクラウドに格納されるので、ユーザーはあらゆるデバイスからデータを利用できます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-442">The data is available to the user from all devices because it's stored in the cloud.</span></span>
    
- <span data-ttu-id="b87a3-443">手順2、3、および4で取得したキー、Id、および Url の例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-443">Here's an example of the keys, IDs, and URLs that are obtained in Steps 2, 3, and 4.</span></span> <span data-ttu-id="b87a3-444">この例には、O365importtool.zip ツールで実行して、PST ファイルを暗号化して Office 365 にアップロードするためのコマンドの構文も含まれています。</span><span class="sxs-lookup"><span data-stu-id="b87a3-444">This example also contains the syntax for the command that you run in the O365ImportTool.exe tool to encrypt and upload PST files to Office 365.</span></span> <span data-ttu-id="b87a3-445">パスワードやその他のセキュリティ関連情報を保護するのと同じように、これらのファイルを保護するための予防策を必ず講じてください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-445">Be sure to take precautions to protect these just like you would protect passwords or other security-related information.</span></span>
    
  ```text
  Symmetric key: l+R+Umc5RGmSBh1oW+DoyMxm/h5h2JJXFcNOFiNp867=

  BPOSId: 42745b33-2a5c-4726-8a2a-ca43caa0f74b

  LicensingIntranetDistributionPointUrl (RMS licensing location): https://afcbd8ec-cb2b-4a1a-8246-0b4bc22d1978.rms.na.aadrm.com/_wmcs/licensing
  
  SAS URL: https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D
  
  O365ImportTool.exe /srcdir:<Location of PST files> /protect-rmsserver:<RMS licensing location> /protect-tenantid:<BPOSId> /protect-key:<Symmetric key> /transfer:upload /upload-dest:<Network upload URL from the SAS URL> /upload-destSAS:<SAS key from the SAS URL>
  
  EXAMPLES
  
  This example uploads PST files to the root of the Azure storage location:

  O365ImportTool.exe /srcdir:\\FILESERVER01\PSTs /protect-rmsserver:"https://afcbd8ec-cb2b-4a1a-8246-0b4bc22d1978.rms.na.aadrm.com/_wmcs/licensing" /protect-tenantid:42745b33-2a5c-4726-8a2a-ca43caa0f74b /protect-ownerid:45beb445-4d06-47df-8e61-6ca1a88a080e /protect-key:"l+R+Umc5RGmSBh1oW+DoyMxm/h5h2JJXFcNOFiNp867=" /transfer:upload /upload-dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata" /upload-destSAS:"?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"
  
  This example uploads PST files to a subfolder named EncryptedPSTs  in the Azure storage location:
  
  O365ImportTool.exe /srcdir:\\FILESERVER01\PSTs /protect-rmsserver:"https://afcbd8ec-cb2b-4a1a-8246-0b4bc22d1978.rms.na.aadrm.com/_wmcs/licensing" /protect-tenantid:42745b33-2a5c-4726-8a2a-ca43caa0f74b /protect-ownerid:45beb445-4d06-47df-8e61-6ca1a88a080e /protect-key:"l+R+Umc5RGmSBh1oW+DoyMxm/h5h2JJXFcNOFiNp867=" /transfer:upload /upload-dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/EncryptedPSTs" /upload-destSAS:"?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"
  ```

- <span data-ttu-id="b87a3-446">前述したように、Office 365 インポートサービスは、PST ファイルがメールボックスにインポートされた後、保持ホールドの設定 (無期限) を有効にします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-446">As previously explained, the Office 365 Import service turns on the retention hold setting (for an indefinite duration) after PST files are imported to a mailbox.</span></span> <span data-ttu-id="b87a3-447">つまり、 *RentionHoldEnabled*プロパティはに`True`設定されているため、メールボックスに割り当てられたアイテム保持ポリシーは処理されません。</span><span class="sxs-lookup"><span data-stu-id="b87a3-447">This means the  *RentionHoldEnabled*  property is set to  `True` so that the retention policy assigned to the mailbox won't be processed.</span></span> <span data-ttu-id="b87a3-448">これにより、メールボックスの所有者は、削除またはアーカイブポリシーによる古いメッセージの削除またはアーカイブを禁止して、新しくインポートされたメッセージを管理できるようになります。</span><span class="sxs-lookup"><span data-stu-id="b87a3-448">This gives the mailbox owner time to manage the newly imported messages by preventing a deletion or archive policy from deleting or archiving older messages.</span></span> <span data-ttu-id="b87a3-449">この保持ホールドを管理するために実行できるいくつかの手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-449">Here are some steps you can take to manage this retention hold:</span></span> 
    
  - <span data-ttu-id="b87a3-450">一定の期間が経過した後、 `Set-Mailbox -RetentionHoldEnabled $false`コマンドを実行して保存機能を無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-450">After a certain period of time, you can turn off the retention hold by running the  `Set-Mailbox -RetentionHoldEnabled $false` command.</span></span> <span data-ttu-id="b87a3-451">手順については、「[メールボックスを保持ホールドの状態にする](https://go.microsoft.com/fwlink/p/?LinkId=544749)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-451">For instructions, see [Place a mailbox on retention hold](https://go.microsoft.com/fwlink/p/?LinkId=544749).</span></span>
    
  - <span data-ttu-id="b87a3-452">今後、ある日付に無効になるように、保存機能を構成することができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-452">You can configure the retention hold so that it's turned off on some date in the future.</span></span> <span data-ttu-id="b87a3-453">そのためには、 `Set-Mailbox -EndDateForRetentionHold <date>`コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-453">You do this by running the  `Set-Mailbox -EndDateForRetentionHold <date>` command.</span></span> <span data-ttu-id="b87a3-454">たとえば、今日の日付が2016年6月1日で、保存機能を30日以内に無効にする場合は、次のコマンド`Set-Mailbox -EndDateForRetentionHold 7/1/2016`を実行します。</span><span class="sxs-lookup"><span data-stu-id="b87a3-454">For example, assuming that today's date is June 1, 2016 and you want the retention hold turned off in 30 days, you would run the following command:  `Set-Mailbox -EndDateForRetentionHold 7/1/2016`.</span></span> <span data-ttu-id="b87a3-455">このシナリオでは、 *RentionHoldEnabled*プロパティをに`True`設定したままにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-455">In this scenario, you would leave the  *RentionHoldEnabled*  property set to `True`.</span></span> <span data-ttu-id="b87a3-456">詳細については、「[メールボックスの設定](https://go.microsoft.com/fwlink/p/?LinkId=150317)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-456">For more information, see [Set-Mailbox](https://go.microsoft.com/fwlink/p/?LinkId=150317).</span></span>
    
  - <span data-ttu-id="b87a3-457">メールボックスに割り当てられているアイテム保持ポリシーの設定を変更して、インポートした古いアイテムがすぐに削除されるか、ユーザーのアーカイブメールボックスに移動されないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-457">You can change the settings for the retention policy that's assigned to the mailbox so that older items that were imported won't be immediately deleted or moved to the user's archive mailbox.</span></span> <span data-ttu-id="b87a3-458">たとえば、メールボックスに割り当てられている削除ポリシーまたはアーカイブポリシーの保存期間を長くすることができます。</span><span class="sxs-lookup"><span data-stu-id="b87a3-458">For example, you could lengthen the retention age for a deletion or archive policy that's assigned to the mailbox.</span></span> <span data-ttu-id="b87a3-459">このシナリオでは、アイテム保持ポリシーの設定を変更した後、メールボックスの保存機能をオフにします。</span><span class="sxs-lookup"><span data-stu-id="b87a3-459">In this scenario, you would turn off the retention hold on the mailbox after you changed the settings of the retention policy.</span></span> <span data-ttu-id="b87a3-460">詳細については、「 [Office 365 組織のメールボックスのアーカイブおよび削除ポリシーをセットアップする](set-up-an-archive-and-deletion-policy-for-mailboxes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b87a3-460">For more information, see [Set up an archive and deletion policy for mailboxes in your Office 365 organization](set-up-an-archive-and-deletion-policy-for-mailboxes.md).</span></span>
